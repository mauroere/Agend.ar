"use strict";(()=>{var e={};e.id=7712,e.ids=[7712],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},1037:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>_,patchFetch:()=>g,requestAsyncStorage:()=>f,routeModule:()=>x,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{DELETE:()=>c,PATCH:()=>p});var s=r(9303),o=r(8716),n=r(670),i=r(7070),l=r(1067),u=r(3719);let d=l.Ry({fullName:l.Z_().min(2).max(160).optional(),bio:l.Z_().max(1200).optional().nullable(),avatarUrl:l.Z_().url().optional().nullable(),color:l.Z_().max(16).optional().nullable(),defaultLocationId:l.Z_().uuid().optional().nullable(),active:l.O7().optional(),specialties:l.IX(l.Z_().max(60)).optional()});async function p(e,{params:t}){let r=await (0,u.o)(e);if("error"in r)return r.error;let{db:a,tenantId:s}=r,o=t.id;if(!o)return i.NextResponse.json({error:"Falta ID"},{status:400});let n=await e.json().catch(()=>({})),l=d.safeParse(n);if(!l.success)return i.NextResponse.json({error:"Datos inv\xe1lidos",issues:l.error.issues},{status:400});let p={},{fullName:c,bio:x,avatarUrl:f,color:m,defaultLocationId:v,active:_,specialties:g}=l.data;if("string"==typeof c&&(p.full_name=c),void 0!==x&&(p.bio=x),void 0!==f&&(p.avatar_url=f),void 0!==m&&(p.color=m),void 0!==v&&(p.default_location_id=v),"boolean"==typeof _&&(p.active=_),g&&(p.specialties=g),p.default_location_id){let{data:e,error:t}=await a.from("agenda_locations").select("id").eq("id",p.default_location_id).eq("tenant_id",s).maybeSingle();if(t||!e)return i.NextResponse.json({error:"Ubicaci\xf3n inv\xe1lida"},{status:400})}let{error:j}=await a.from("agenda_providers").update(p).eq("id",o).eq("tenant_id",s);return j?i.NextResponse.json({error:j.message},{status:400}):i.NextResponse.json({ok:!0})}async function c(e,{params:t}){let r=await (0,u.o)(e);if("error"in r)return r.error;let{db:a,tenantId:s}=r,o=t.id;if(!o)return i.NextResponse.json({error:"Falta ID"},{status:400});let{error:n}=await a.from("agenda_providers").delete().eq("id",o).eq("tenant_id",s);return n?i.NextResponse.json({error:n.message},{status:400}):i.NextResponse.json({ok:!0})}let x=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/settings/providers/[id]/route",pathname:"/api/settings/providers/[id]",filename:"route",bundlePath:"app/api/settings/providers/[id]/route"},resolvedPagePath:"C:\\Users\\rementeriama\\Downloads\\Code\\Agend.ar\\src\\app\\api\\settings\\providers\\[id]\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:v}=x,_="/api/settings/providers/[id]/route";function g(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},3837:(e,t,r)=>{r.d(t,{j:()=>o});var a=r(1615),s=r(344);function o(){return(0,s.createRouteHandlerClient)({cookies:a.cookies})}},5072:(e,t,r)=>{r.d(t,{o:()=>n});var a=r(7857);let s="https://oaxielrsiogvnxradtsw.supabase.co",o=process.env.SUPABASE_SERVICE_ROLE_KEY;s&&o||console.warn("Supabase service client is not fully configured.");let n=s&&o?(0,a.eI)(s,o,{auth:{persistSession:!1}}):null},3719:(e,t,r)=>{r.d(t,{o:()=>n});var a=r(7070),s=r(3837),o=r(5072);async function n(e){let t=(0,s.j)(),{data:{session:r}}=await t.auth.getSession();if(!r)return{error:a.NextResponse.json({error:"Unauthorized"},{status:401})};let n=o.o??t,i=r.user.app_metadata?.tenant_id??r.user.user_metadata?.tenant_id??null;if(!i){let{data:e}=await n.from("agenda_users").select("tenant_id").eq("id",r.user.id).maybeSingle();e&&(i=e.tenant_id)}let l=e.headers.get("x-tenant-id"),u=i??l;return u?l&&i&&l!==i?{error:a.NextResponse.json({error:"Tenant mismatch"},{status:403})}:{supabase:t,db:n,tenantId:u,session:r}:{error:a.NextResponse.json({error:"Unauthorized"},{status:401})}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,7857,5972,958,1067],()=>r(1037));module.exports=a})();