"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/appointments/route";
exports.ids = ["app/api/appointments/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fappointments%2Froute&page=%2Fapi%2Fappointments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fappointments%2Froute.ts&appDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fappointments%2Froute&page=%2Fapi%2Fappointments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fappointments%2Froute.ts&appDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_rementeriama_Downloads_Code_Agend_ar_src_app_api_appointments_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/appointments/route.ts */ \"(rsc)/./src/app/api/appointments/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/appointments/route\",\n        pathname: \"/api/appointments\",\n        filename: \"route\",\n        bundlePath: \"app/api/appointments/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\rementeriama\\\\Downloads\\\\Code\\\\Agend.ar\\\\src\\\\app\\\\api\\\\appointments\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_rementeriama_Downloads_Code_Agend_ar_src_app_api_appointments_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/appointments/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhcHBvaW50bWVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFwcG9pbnRtZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFwcG9pbnRtZW50cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNyZW1lbnRlcmlhbWElNUNEb3dubG9hZHMlNUNDb2RlJTVDQWdlbmQuYXIlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3JlbWVudGVyaWFtYSU1Q0Rvd25sb2FkcyU1Q0NvZGUlNUNBZ2VuZC5hciZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZ2VuZGFyLWFwcC8/NDViNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxyZW1lbnRlcmlhbWFcXFxcRG93bmxvYWRzXFxcXENvZGVcXFxcQWdlbmQuYXJcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXBwb2ludG1lbnRzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hcHBvaW50bWVudHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hcHBvaW50bWVudHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FwcG9pbnRtZW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXHJlbWVudGVyaWFtYVxcXFxEb3dubG9hZHNcXFxcQ29kZVxcXFxBZ2VuZC5hclxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhcHBvaW50bWVudHNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FwcG9pbnRtZW50cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fappointments%2Froute&page=%2Fapi%2Fappointments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fappointments%2Froute.ts&appDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/appointments/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/appointments/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_route__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/route */ \"(rsc)/./src/lib/supabase/route.ts\");\n/* harmony import */ var _lib_supabase_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/service */ \"(rsc)/./src/lib/supabase/service.ts\");\n/* harmony import */ var _server_appointments_createAppointment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/server/appointments/createAppointment */ \"(rsc)/./src/server/appointments/createAppointment.ts\");\n/* harmony import */ var _server_tenant_headers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/server/tenant-headers */ \"(rsc)/./src/server/tenant-headers.ts\");\n\n\n\n\n\nasync function POST(request) {\n    const supabase = (0,_lib_supabase_route__WEBPACK_IMPORTED_MODULE_1__.getRouteSupabase)();\n    const { data: auth } = await supabase.auth.getSession();\n    const tokenTenant = auth.session?.user?.app_metadata?.tenant_id ?? auth.session?.user?.user_metadata?.tenant_id ?? null;\n    const headerInfo = (0,_server_tenant_headers__WEBPACK_IMPORTED_MODULE_4__.getTenantHeaderInfo)(request.headers);\n    const tenantId = tokenTenant ?? headerInfo.internalId;\n    if (!auth.session || !tenantId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Unauthorized\"\n        }, {\n            status: 401\n        });\n    }\n    if (headerInfo.internalId && tokenTenant && headerInfo.internalId !== tokenTenant && !headerInfo.isDevBypass) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Tenant mismatch\"\n        }, {\n            status: 403\n        });\n    }\n    // Use serviceClient for DB operations to bypass RLS in dev/mismatch scenarios\n    const db = _lib_supabase_service__WEBPACK_IMPORTED_MODULE_2__.serviceClient ?? supabase;\n    const body = await request.json();\n    const { patient, phone, start, duration, service, notes, location_id, serviceId, providerId } = body ?? {};\n    try {\n        const { appointment } = await (0,_server_appointments_createAppointment__WEBPACK_IMPORTED_MODULE_3__.createAppointmentForTenant)({\n            db,\n            tenantId,\n            input: {\n                patient,\n                phone,\n                start,\n                duration,\n                serviceName: service ?? null,\n                notes: notes ?? null,\n                locationId: location_id ?? null,\n                serviceId: serviceId ?? null,\n                providerId: providerId ?? null\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            appointment\n        });\n    } catch (error) {\n        if (error instanceof _server_appointments_createAppointment__WEBPACK_IMPORTED_MODULE_3__.AppointmentCreationError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: error.status\n            });\n        }\n        console.error(\"appointment.create_unexpected_error\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Error inesperado\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hcHBvaW50bWVudHMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXdEO0FBRUE7QUFDRDtBQUV3RDtBQUNqRDtBQUV2RCxlQUFlTSxLQUFLQyxPQUFvQjtJQUM3QyxNQUFNQyxXQUFXUCxxRUFBZ0JBO0lBQ2pDLE1BQU0sRUFBRVEsTUFBTUMsSUFBSSxFQUFFLEdBQUcsTUFBTUYsU0FBU0UsSUFBSSxDQUFDQyxVQUFVO0lBQ3JELE1BQU1DLGNBQWMsS0FBTUMsT0FBTyxFQUFFQyxNQUFNQyxjQUFxREMsYUFDeEZOLEtBQUtHLE9BQU8sRUFBRUMsTUFBTUcsZUFBc0RELGFBQzNFO0lBQ0wsTUFBTUUsYUFBYWIsMkVBQW1CQSxDQUFDRSxRQUFRWSxPQUFPO0lBQ3RELE1BQU1DLFdBQVdSLGVBQWVNLFdBQVdHLFVBQVU7SUFFckQsSUFBSSxDQUFDWCxLQUFLRyxPQUFPLElBQUksQ0FBQ08sVUFBVTtRQUM5QixPQUFPcEIscURBQVlBLENBQUNzQixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFlLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3BFO0lBRUEsSUFBSU4sV0FBV0csVUFBVSxJQUFJVCxlQUFlTSxXQUFXRyxVQUFVLEtBQUtULGVBQWUsQ0FBQ00sV0FBV08sV0FBVyxFQUFFO1FBQzVHLE9BQU96QixxREFBWUEsQ0FBQ3NCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWtCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3ZFO0lBRUEsOEVBQThFO0lBQzlFLE1BQU1FLEtBQUt4QixnRUFBYUEsSUFBSU07SUFFNUIsTUFBTW1CLE9BQU8sTUFBTXBCLFFBQVFlLElBQUk7SUFDL0IsTUFBTSxFQUFFTSxPQUFPLEVBQUVDLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUVDLE9BQU8sRUFBRUMsS0FBSyxFQUFFQyxXQUFXLEVBQUVDLFNBQVMsRUFBRUMsVUFBVSxFQUFFLEdBQUdULFFBQVEsQ0FBQztJQUV6RyxJQUFJO1FBQ0YsTUFBTSxFQUFFVSxXQUFXLEVBQUUsR0FBRyxNQUFNakMsa0dBQTBCQSxDQUFDO1lBQ3ZEc0I7WUFDQU47WUFDQWtCLE9BQU87Z0JBQ0xWO2dCQUNBQztnQkFDQUM7Z0JBQ0FDO2dCQUNBUSxhQUFhUCxXQUFXO2dCQUN4QkMsT0FBT0EsU0FBUztnQkFDaEJPLFlBQVlOLGVBQWU7Z0JBQzNCQyxXQUFXQSxhQUFhO2dCQUN4QkMsWUFBWUEsY0FBYztZQUM1QjtRQUNGO1FBRUEsT0FBT3BDLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO1lBQUVtQixJQUFJO1lBQU1KO1FBQVk7SUFDbkQsRUFBRSxPQUFPZCxPQUFPO1FBQ2QsSUFBSUEsaUJBQWlCcEIsNEZBQXdCQSxFQUFFO1lBQzdDLE9BQU9ILHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO2dCQUFFQyxPQUFPQSxNQUFNbUIsT0FBTztZQUFDLEdBQUc7Z0JBQUVsQixRQUFRRCxNQUFNQyxNQUFNO1lBQUM7UUFDNUU7UUFFQW1CLFFBQVFwQixLQUFLLENBQUMsdUNBQXVDQTtRQUNyRCxPQUFPdkIscURBQVlBLENBQUNzQixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFtQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUN4RTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbmRhci1hcHAvLi9zcmMvYXBwL2FwaS9hcHBvaW50bWVudHMvcm91dGUudHM/OTc1NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IFN1cGFiYXNlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xyXG5pbXBvcnQgeyBnZXRSb3V0ZVN1cGFiYXNlIH0gZnJvbSBcIkAvbGliL3N1cGFiYXNlL3JvdXRlXCI7XHJcbmltcG9ydCB7IHNlcnZpY2VDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Uvc2VydmljZVwiO1xyXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gXCJAL3R5cGVzL2RhdGFiYXNlXCI7XHJcbmltcG9ydCB7IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvciwgY3JlYXRlQXBwb2ludG1lbnRGb3JUZW5hbnQgfSBmcm9tIFwiQC9zZXJ2ZXIvYXBwb2ludG1lbnRzL2NyZWF0ZUFwcG9pbnRtZW50XCI7XHJcbmltcG9ydCB7IGdldFRlbmFudEhlYWRlckluZm8gfSBmcm9tIFwiQC9zZXJ2ZXIvdGVuYW50LWhlYWRlcnNcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgY29uc3Qgc3VwYWJhc2UgPSBnZXRSb3V0ZVN1cGFiYXNlKCkgYXMgdW5rbm93biBhcyBTdXBhYmFzZUNsaWVudDxEYXRhYmFzZT47XHJcbiAgY29uc3QgeyBkYXRhOiBhdXRoIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcclxuICBjb25zdCB0b2tlblRlbmFudCA9IChhdXRoLnNlc3Npb24/LnVzZXI/LmFwcF9tZXRhZGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkKT8udGVuYW50X2lkXHJcbiAgICA/PyAoYXV0aC5zZXNzaW9uPy51c2VyPy51c2VyX21ldGFkYXRhIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQpPy50ZW5hbnRfaWRcclxuICAgID8/IG51bGw7XHJcbiAgY29uc3QgaGVhZGVySW5mbyA9IGdldFRlbmFudEhlYWRlckluZm8ocmVxdWVzdC5oZWFkZXJzIGFzIEhlYWRlcnMpO1xyXG4gIGNvbnN0IHRlbmFudElkID0gdG9rZW5UZW5hbnQgPz8gaGVhZGVySW5mby5pbnRlcm5hbElkO1xyXG5cclxuICBpZiAoIWF1dGguc2Vzc2lvbiB8fCAhdGVuYW50SWQpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoaGVhZGVySW5mby5pbnRlcm5hbElkICYmIHRva2VuVGVuYW50ICYmIGhlYWRlckluZm8uaW50ZXJuYWxJZCAhPT0gdG9rZW5UZW5hbnQgJiYgIWhlYWRlckluZm8uaXNEZXZCeXBhc3MpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlRlbmFudCBtaXNtYXRjaFwiIH0sIHsgc3RhdHVzOiA0MDMgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBVc2Ugc2VydmljZUNsaWVudCBmb3IgREIgb3BlcmF0aW9ucyB0byBieXBhc3MgUkxTIGluIGRldi9taXNtYXRjaCBzY2VuYXJpb3NcclxuICBjb25zdCBkYiA9IHNlcnZpY2VDbGllbnQgPz8gc3VwYWJhc2U7XHJcblxyXG4gIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuICBjb25zdCB7IHBhdGllbnQsIHBob25lLCBzdGFydCwgZHVyYXRpb24sIHNlcnZpY2UsIG5vdGVzLCBsb2NhdGlvbl9pZCwgc2VydmljZUlkLCBwcm92aWRlcklkIH0gPSBib2R5ID8/IHt9O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBhcHBvaW50bWVudCB9ID0gYXdhaXQgY3JlYXRlQXBwb2ludG1lbnRGb3JUZW5hbnQoe1xyXG4gICAgICBkYixcclxuICAgICAgdGVuYW50SWQsXHJcbiAgICAgIGlucHV0OiB7XHJcbiAgICAgICAgcGF0aWVudCxcclxuICAgICAgICBwaG9uZSxcclxuICAgICAgICBzdGFydCxcclxuICAgICAgICBkdXJhdGlvbixcclxuICAgICAgICBzZXJ2aWNlTmFtZTogc2VydmljZSA/PyBudWxsLFxyXG4gICAgICAgIG5vdGVzOiBub3RlcyA/PyBudWxsLFxyXG4gICAgICAgIGxvY2F0aW9uSWQ6IGxvY2F0aW9uX2lkID8/IG51bGwsXHJcbiAgICAgICAgc2VydmljZUlkOiBzZXJ2aWNlSWQgPz8gbnVsbCxcclxuICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlcklkID8/IG51bGwsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazogdHJ1ZSwgYXBwb2ludG1lbnQgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogZXJyb3Iuc3RhdHVzIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUuZXJyb3IoXCJhcHBvaW50bWVudC5jcmVhdGVfdW5leHBlY3RlZF9lcnJvclwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJFcnJvciBpbmVzcGVyYWRvXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFJvdXRlU3VwYWJhc2UiLCJzZXJ2aWNlQ2xpZW50IiwiQXBwb2ludG1lbnRDcmVhdGlvbkVycm9yIiwiY3JlYXRlQXBwb2ludG1lbnRGb3JUZW5hbnQiLCJnZXRUZW5hbnRIZWFkZXJJbmZvIiwiUE9TVCIsInJlcXVlc3QiLCJzdXBhYmFzZSIsImRhdGEiLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsInRva2VuVGVuYW50Iiwic2Vzc2lvbiIsInVzZXIiLCJhcHBfbWV0YWRhdGEiLCJ0ZW5hbnRfaWQiLCJ1c2VyX21ldGFkYXRhIiwiaGVhZGVySW5mbyIsImhlYWRlcnMiLCJ0ZW5hbnRJZCIsImludGVybmFsSWQiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJpc0RldkJ5cGFzcyIsImRiIiwiYm9keSIsInBhdGllbnQiLCJwaG9uZSIsInN0YXJ0IiwiZHVyYXRpb24iLCJzZXJ2aWNlIiwibm90ZXMiLCJsb2NhdGlvbl9pZCIsInNlcnZpY2VJZCIsInByb3ZpZGVySWQiLCJhcHBvaW50bWVudCIsImlucHV0Iiwic2VydmljZU5hbWUiLCJsb2NhdGlvbklkIiwib2siLCJtZXNzYWdlIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/appointments/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/constants.ts":
/*!******************************!*\
  !*** ./src/lib/constants.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APPOINTMENT_STATUS: () => (/* binding */ APPOINTMENT_STATUS),\n/* harmony export */   APP_TIMEZONE: () => (/* binding */ APP_TIMEZONE),\n/* harmony export */   CRON_SECRET_HEADER: () => (/* binding */ CRON_SECRET_HEADER),\n/* harmony export */   DEFAULT_SLOT_DURATION_MIN: () => (/* binding */ DEFAULT_SLOT_DURATION_MIN),\n/* harmony export */   SLOT_LOOKAHEAD_DAYS: () => (/* binding */ SLOT_LOOKAHEAD_DAYS),\n/* harmony export */   WAITLIST_LOOKAHEAD_HOURS: () => (/* binding */ WAITLIST_LOOKAHEAD_HOURS)\n/* harmony export */ });\nconst APP_TIMEZONE = \"America/Argentina/Buenos_Aires\";\nconst DEFAULT_SLOT_DURATION_MIN = 30;\nconst SLOT_LOOKAHEAD_DAYS = 7;\nconst WAITLIST_LOOKAHEAD_HOURS = 48;\nconst APPOINTMENT_STATUS = [\n    \"pending\",\n    \"confirmed\",\n    \"reschedule_requested\",\n    \"canceled\",\n    \"completed\",\n    \"no_show\"\n];\nconst CRON_SECRET_HEADER = \"x-cron-secret\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbnN0YW50cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBTyxNQUFNQSxlQUFlLGlDQUEwQztBQUMvRCxNQUFNQyw0QkFBNEIsR0FBRztBQUNyQyxNQUFNQyxzQkFBc0IsRUFBRTtBQUM5QixNQUFNQywyQkFBMkIsR0FBRztBQUVwQyxNQUFNQyxxQkFBcUI7SUFDaEM7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0QsQ0FBVTtBQUlKLE1BQU1DLHFCQUFxQixnQkFBZ0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZ2VuZGFyLWFwcC8uL3NyYy9saWIvY29uc3RhbnRzLnRzP2ZiZjkiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IEFQUF9USU1FWk9ORSA9IFwiQW1lcmljYS9BcmdlbnRpbmEvQnVlbm9zX0FpcmVzXCIgYXMgY29uc3Q7XHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NMT1RfRFVSQVRJT05fTUlOID0gMzA7XHJcbmV4cG9ydCBjb25zdCBTTE9UX0xPT0tBSEVBRF9EQVlTID0gNztcclxuZXhwb3J0IGNvbnN0IFdBSVRMSVNUX0xPT0tBSEVBRF9IT1VSUyA9IDQ4O1xyXG5cclxuZXhwb3J0IGNvbnN0IEFQUE9JTlRNRU5UX1NUQVRVUyA9IFtcclxuICBcInBlbmRpbmdcIixcclxuICBcImNvbmZpcm1lZFwiLFxyXG4gIFwicmVzY2hlZHVsZV9yZXF1ZXN0ZWRcIixcclxuICBcImNhbmNlbGVkXCIsXHJcbiAgXCJjb21wbGV0ZWRcIixcclxuICBcIm5vX3Nob3dcIixcclxuXSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCB0eXBlIEFwcG9pbnRtZW50U3RhdHVzID0gKHR5cGVvZiBBUFBPSU5UTUVOVF9TVEFUVVMpW251bWJlcl07XHJcblxyXG5leHBvcnQgY29uc3QgQ1JPTl9TRUNSRVRfSEVBREVSID0gXCJ4LWNyb24tc2VjcmV0XCI7XHJcbiJdLCJuYW1lcyI6WyJBUFBfVElNRVpPTkUiLCJERUZBVUxUX1NMT1RfRFVSQVRJT05fTUlOIiwiU0xPVF9MT09LQUhFQURfREFZUyIsIldBSVRMSVNUX0xPT0tBSEVBRF9IT1VSUyIsIkFQUE9JTlRNRU5UX1NUQVRVUyIsIkNST05fU0VDUkVUX0hFQURFUiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/constants.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/logging.ts":
/*!****************************!*\
  !*** ./src/lib/logging.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   log: () => (/* binding */ log),\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logInfo: () => (/* binding */ logInfo),\n/* harmony export */   logWarn: () => (/* binding */ logWarn)\n/* harmony export */ });\nfunction log(level, message, ctx = {}) {\n    const base = {\n        level,\n        message,\n        timestamp: new Date().toISOString(),\n        ...ctx\n    };\n    // eslint-disable-next-line no-console\n    console[level === \"error\" ? \"error\" : level === \"warn\" ? \"warn\" : \"log\"](JSON.stringify(base));\n    return base;\n}\nfunction logInfo(message, ctx) {\n    return log(\"info\", message, ctx);\n}\nfunction logWarn(message, ctx) {\n    return log(\"warn\", message, ctx);\n}\nfunction logError(message, ctx) {\n    return log(\"error\", message, ctx);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2xvZ2dpbmcudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVlPLFNBQVNBLElBQUlDLEtBQWUsRUFBRUMsT0FBZSxFQUFFQyxNQUFrQixDQUFDLENBQUM7SUFDeEUsTUFBTUMsT0FBTztRQUFFSDtRQUFPQztRQUFTRyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7UUFBSSxHQUFHSixHQUFHO0lBQUM7SUFDM0Usc0NBQXNDO0lBQ3RDSyxPQUFPLENBQUNQLFVBQVUsVUFBVSxVQUFVQSxVQUFVLFNBQVMsU0FBUyxNQUFNLENBQUNRLEtBQUtDLFNBQVMsQ0FBQ047SUFDeEYsT0FBT0E7QUFDVDtBQUVPLFNBQVNPLFFBQVFULE9BQWUsRUFBRUMsR0FBZ0I7SUFDdkQsT0FBT0gsSUFBSSxRQUFRRSxTQUFTQztBQUM5QjtBQUVPLFNBQVNTLFFBQVFWLE9BQWUsRUFBRUMsR0FBZ0I7SUFDdkQsT0FBT0gsSUFBSSxRQUFRRSxTQUFTQztBQUM5QjtBQUVPLFNBQVNVLFNBQVNYLE9BQWUsRUFBRUMsR0FBZ0I7SUFDeEQsT0FBT0gsSUFBSSxTQUFTRSxTQUFTQztBQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FnZW5kYXItYXBwLy4vc3JjL2xpYi9sb2dnaW5nLnRzP2FlMGYiXSwic291cmNlc0NvbnRlbnQiOlsidHlwZSBMb2dMZXZlbCA9IFwiaW5mb1wiIHwgXCJ3YXJuXCIgfCBcImVycm9yXCI7XHJcblxyXG50eXBlIExvZ0NvbnRleHQgPSB7XHJcbiAgdGVuYW50X2lkPzogc3RyaW5nIHwgbnVsbDtcclxuICBsb2NhdGlvbl9pZD86IHN0cmluZyB8IG51bGw7XHJcbiAgYXBwb2ludG1lbnRfaWQ/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHBhdGllbnRfaWQ/OiBzdHJpbmcgfCBudWxsO1xyXG4gIGpvYj86IHN0cmluZztcclxuICBwYXlsb2FkPzogdW5rbm93bjtcclxuICBlcnJvcj86IHVua25vd247XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbG9nKGxldmVsOiBMb2dMZXZlbCwgbWVzc2FnZTogc3RyaW5nLCBjdHg6IExvZ0NvbnRleHQgPSB7fSkge1xyXG4gIGNvbnN0IGJhc2UgPSB7IGxldmVsLCBtZXNzYWdlLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgLi4uY3R4IH07XHJcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICBjb25zb2xlW2xldmVsID09PSBcImVycm9yXCIgPyBcImVycm9yXCIgOiBsZXZlbCA9PT0gXCJ3YXJuXCIgPyBcIndhcm5cIiA6IFwibG9nXCJdKEpTT04uc3RyaW5naWZ5KGJhc2UpKTtcclxuICByZXR1cm4gYmFzZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0luZm8obWVzc2FnZTogc3RyaW5nLCBjdHg/OiBMb2dDb250ZXh0KSB7XHJcbiAgcmV0dXJuIGxvZyhcImluZm9cIiwgbWVzc2FnZSwgY3R4KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1dhcm4obWVzc2FnZTogc3RyaW5nLCBjdHg/OiBMb2dDb250ZXh0KSB7XHJcbiAgcmV0dXJuIGxvZyhcIndhcm5cIiwgbWVzc2FnZSwgY3R4KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0Vycm9yKG1lc3NhZ2U6IHN0cmluZywgY3R4PzogTG9nQ29udGV4dCkge1xyXG4gIHJldHVybiBsb2coXCJlcnJvclwiLCBtZXNzYWdlLCBjdHgpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJsb2ciLCJsZXZlbCIsIm1lc3NhZ2UiLCJjdHgiLCJiYXNlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiY29uc29sZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb2dJbmZvIiwibG9nV2FybiIsImxvZ0Vycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/logging.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/messages.ts":
/*!*****************************!*\
  !*** ./src/lib/messages.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TEMPLATE_NAMES: () => (/* binding */ TEMPLATE_NAMES),\n/* harmony export */   templatePreview: () => (/* binding */ templatePreview)\n/* harmony export */ });\nconst TEMPLATE_NAMES = {\n    appointmentCreated: \"appointment_created\",\n    reminder24h: \"reminder_24h\",\n    reminder2h: \"reminder_2h\",\n    waitlistOffer: \"waitlist_offer\"\n};\nconst templatePreview = {\n    [TEMPLATE_NAMES.appointmentCreated]: \"Hola {{1}}, agendamos tu turno para {{2}} a las {{3}} en {{4}}. Respond\\xe9 1 Confirmar \\xb7 2 Reprogramar \\xb7 3 Cancelar \\xb7 STOP para salir.\",\n    [TEMPLATE_NAMES.reminder24h]: \"Recordatorio {{1}} ma\\xf1ana {{2}}. Respond\\xe9 1 Confirmar \\xb7 2 Reprogramar \\xb7 3 Cancelar \\xb7 STOP.\",\n    [TEMPLATE_NAMES.reminder2h]: \"Nos vemos hoy {{1}} a las {{2}}. Si necesit\\xe1s moverlo respond\\xe9 2, cancelar 3.\",\n    [TEMPLATE_NAMES.waitlistOffer]: \"Se liber\\xf3 un turno {{1}} a las {{2}}. Respond\\xe9 SI para tomarlo o STOP para salir.\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21lc3NhZ2VzLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQU8sTUFBTUEsaUJBQWlCO0lBQzVCQyxvQkFBb0I7SUFDcEJDLGFBQWE7SUFDYkMsWUFBWTtJQUNaQyxlQUFlO0FBQ2pCLEVBQVc7QUFTSixNQUFNQyxrQkFBa0I7SUFDN0IsQ0FBQ0wsZUFBZUMsa0JBQWtCLENBQUMsRUFDakM7SUFDRixDQUFDRCxlQUFlRSxXQUFXLENBQUMsRUFDMUI7SUFDRixDQUFDRixlQUFlRyxVQUFVLENBQUMsRUFDekI7SUFDRixDQUFDSCxlQUFlSSxhQUFhLENBQUMsRUFDNUI7QUFDSixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbmRhci1hcHAvLi9zcmMvbGliL21lc3NhZ2VzLnRzP2I0NjUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IFRFTVBMQVRFX05BTUVTID0ge1xyXG4gIGFwcG9pbnRtZW50Q3JlYXRlZDogXCJhcHBvaW50bWVudF9jcmVhdGVkXCIsXHJcbiAgcmVtaW5kZXIyNGg6IFwicmVtaW5kZXJfMjRoXCIsXHJcbiAgcmVtaW5kZXIyaDogXCJyZW1pbmRlcl8yaFwiLFxyXG4gIHdhaXRsaXN0T2ZmZXI6IFwid2FpdGxpc3Rfb2ZmZXJcIixcclxufSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCB0eXBlIFRlbXBsYXRlUnVuQ29udGV4dCA9IHtcclxuICBwYXRpZW50TmFtZTogc3RyaW5nO1xyXG4gIGRhdGU6IHN0cmluZztcclxuICB0aW1lOiBzdHJpbmc7XHJcbiAgbG9jYXRpb246IHN0cmluZztcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB0ZW1wbGF0ZVByZXZpZXcgPSB7XHJcbiAgW1RFTVBMQVRFX05BTUVTLmFwcG9pbnRtZW50Q3JlYXRlZF06XHJcbiAgICBcIkhvbGEge3sxfX0sIGFnZW5kYW1vcyB0dSB0dXJubyBwYXJhIHt7Mn19IGEgbGFzIHt7M319IGVuIHt7NH19LiBSZXNwb25kw6kgMSBDb25maXJtYXIgwrcgMiBSZXByb2dyYW1hciDCtyAzIENhbmNlbGFyIMK3IFNUT1AgcGFyYSBzYWxpci5cIixcclxuICBbVEVNUExBVEVfTkFNRVMucmVtaW5kZXIyNGhdOlxyXG4gICAgXCJSZWNvcmRhdG9yaW8ge3sxfX0gbWHDsWFuYSB7ezJ9fS4gUmVzcG9uZMOpIDEgQ29uZmlybWFyIMK3IDIgUmVwcm9ncmFtYXIgwrcgMyBDYW5jZWxhciDCtyBTVE9QLlwiLFxyXG4gIFtURU1QTEFURV9OQU1FUy5yZW1pbmRlcjJoXTpcclxuICAgIFwiTm9zIHZlbW9zIGhveSB7ezF9fSBhIGxhcyB7ezJ9fS4gU2kgbmVjZXNpdMOhcyBtb3ZlcmxvIHJlc3BvbmTDqSAyLCBjYW5jZWxhciAzLlwiLFxyXG4gIFtURU1QTEFURV9OQU1FUy53YWl0bGlzdE9mZmVyXTpcclxuICAgIFwiU2UgbGliZXLDsyB1biB0dXJubyB7ezF9fSBhIGxhcyB7ezJ9fS4gUmVzcG9uZMOpIFNJIHBhcmEgdG9tYXJsbyBvIFNUT1AgcGFyYSBzYWxpci5cIixcclxufTtcclxuIl0sIm5hbWVzIjpbIlRFTVBMQVRFX05BTUVTIiwiYXBwb2ludG1lbnRDcmVhdGVkIiwicmVtaW5kZXIyNGgiLCJyZW1pbmRlcjJoIiwid2FpdGxpc3RPZmZlciIsInRlbXBsYXRlUHJldmlldyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/messages.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/scheduling.ts":
/*!*******************************!*\
  !*** ./src/lib/scheduling.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calculateAvailability: () => (/* binding */ calculateAvailability),\n/* harmony export */   isWithinBusinessHours: () => (/* binding */ isWithinBusinessHours)\n/* harmony export */ });\n/* harmony import */ var _barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! __barrel_optimize__?names=addMinutes,isBefore!=!date-fns */ \"(rsc)/./node_modules/date-fns/isBefore.mjs\");\n/* harmony import */ var _barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! __barrel_optimize__?names=addMinutes,isBefore!=!date-fns */ \"(rsc)/./node_modules/date-fns/addMinutes.mjs\");\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/constants */ \"(rsc)/./src/lib/constants.ts\");\n\n\nfunction isWithinBusinessHours(options) {\n    const { start, end, businessHours, timeZone } = options;\n    const fmt = new Intl.DateTimeFormat(\"en-US\", {\n        timeZone,\n        weekday: \"short\",\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        hour12: false\n    });\n    const partsStart = Object.fromEntries(fmt.formatToParts(start).map((p)=>[\n            p.type,\n            p.value\n        ]));\n    const partsEnd = Object.fromEntries(fmt.formatToParts(end).map((p)=>[\n            p.type,\n            p.value\n        ]));\n    const dayKey = (partsStart.weekday ?? \"\").slice(0, 3).toLowerCase(); // mon/tue...\n    if (dayKey !== (partsEnd.weekday ?? \"\").slice(0, 3).toLowerCase()) return false;\n    const intervals = businessHours?.[dayKey];\n    if (!intervals || intervals.length === 0) return false;\n    const toMinutes = (h, m)=>Number(h) * 60 + Number(m);\n    const startMinutes = toMinutes(partsStart.hour ?? \"0\", partsStart.minute ?? \"0\");\n    const endMinutes = toMinutes(partsEnd.hour ?? \"0\", partsEnd.minute ?? \"0\");\n    return intervals.some(([from, to])=>{\n        const [fh, fm] = from.split(\":\");\n        const [th, tm] = to.split(\":\");\n        const fromM = toMinutes(fh, fm);\n        const toM = toMinutes(th, tm);\n        return startMinutes >= fromM && endMinutes <= toM;\n    });\n}\nfunction calculateAvailability({ start, end, appointments, durationMinutes = _lib_constants__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_SLOT_DURATION_MIN, bufferMinutes = 0 }) {\n    const slots = [];\n    let cursor = new Date(start);\n    while((0,_barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_1__.isBefore)((0,_barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_2__.addMinutes)(cursor, durationMinutes), end)){\n        const candidateEnd = (0,_barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_2__.addMinutes)(cursor, durationMinutes);\n        const overlaps = appointments.some((appt)=>{\n            const apptStart = new Date(appt.start_at);\n            const apptEnd = new Date(appt.end_at);\n            return cursor < apptEnd && candidateEnd > apptStart;\n        });\n        if (!overlaps) {\n            slots.push({\n                start: new Date(cursor),\n                end: candidateEnd\n            });\n        }\n        cursor = (0,_barrel_optimize_names_addMinutes_isBefore_date_fns__WEBPACK_IMPORTED_MODULE_2__.addMinutes)(cursor, durationMinutes + bufferMinutes);\n    }\n    return slots;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LWFwcC8uL3NyYy9saWIvc2NoZWR1bGluZy50cz8zZWYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFkZE1pbnV0ZXMsIGlzQmVmb3JlIH0gZnJvbSBcImRhdGUtZm5zXCI7XHJcbmltcG9ydCB7IERFRkFVTFRfU0xPVF9EVVJBVElPTl9NSU4gfSBmcm9tIFwiQC9saWIvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IERhdGFiYXNlIH0gZnJvbSBcIkAvdHlwZXMvZGF0YWJhc2VcIjtcclxuXHJcbmV4cG9ydCB0eXBlIEFwcG9pbnRtZW50Um93ID0gRGF0YWJhc2VbXCJwdWJsaWNcIl1bXCJUYWJsZXNcIl1bXCJhZ2VuZGFfYXBwb2ludG1lbnRzXCJdW1wiUm93XCJdO1xyXG5cclxudHlwZSBCdXNpbmVzc0hvdXJzID0gUmVjb3JkPHN0cmluZywgW3N0cmluZywgc3RyaW5nXVtdPjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1dpdGhpbkJ1c2luZXNzSG91cnMob3B0aW9uczoge1xyXG4gIHN0YXJ0OiBEYXRlO1xyXG4gIGVuZDogRGF0ZTtcclxuICBidXNpbmVzc0hvdXJzOiBCdXNpbmVzc0hvdXJzO1xyXG4gIHRpbWVab25lOiBzdHJpbmc7XHJcbn0pIHtcclxuICBjb25zdCB7IHN0YXJ0LCBlbmQsIGJ1c2luZXNzSG91cnMsIHRpbWVab25lIH0gPSBvcHRpb25zO1xyXG4gIGNvbnN0IGZtdCA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KFwiZW4tVVNcIiwge1xyXG4gICAgdGltZVpvbmUsXHJcbiAgICB3ZWVrZGF5OiBcInNob3J0XCIsXHJcbiAgICBob3VyOiBcIjItZGlnaXRcIixcclxuICAgIG1pbnV0ZTogXCIyLWRpZ2l0XCIsXHJcbiAgICBob3VyMTI6IGZhbHNlLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBwYXJ0c1N0YXJ0ID0gT2JqZWN0LmZyb21FbnRyaWVzKGZtdC5mb3JtYXRUb1BhcnRzKHN0YXJ0KS5tYXAoKHApID0+IFtwLnR5cGUsIHAudmFsdWVdKSk7XHJcbiAgY29uc3QgcGFydHNFbmQgPSBPYmplY3QuZnJvbUVudHJpZXMoZm10LmZvcm1hdFRvUGFydHMoZW5kKS5tYXAoKHApID0+IFtwLnR5cGUsIHAudmFsdWVdKSk7XHJcblxyXG4gIGNvbnN0IGRheUtleSA9IChwYXJ0c1N0YXJ0LndlZWtkYXkgPz8gXCJcIikuc2xpY2UoMCwgMykudG9Mb3dlckNhc2UoKTsgLy8gbW9uL3R1ZS4uLlxyXG4gIGlmIChkYXlLZXkgIT09IChwYXJ0c0VuZC53ZWVrZGF5ID8/IFwiXCIpLnNsaWNlKDAsIDMpLnRvTG93ZXJDYXNlKCkpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgY29uc3QgaW50ZXJ2YWxzID0gYnVzaW5lc3NIb3Vycz8uW2RheUtleV07XHJcbiAgaWYgKCFpbnRlcnZhbHMgfHwgaW50ZXJ2YWxzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICBjb25zdCB0b01pbnV0ZXMgPSAoaDogc3RyaW5nLCBtOiBzdHJpbmcpID0+IE51bWJlcihoKSAqIDYwICsgTnVtYmVyKG0pO1xyXG4gIGNvbnN0IHN0YXJ0TWludXRlcyA9IHRvTWludXRlcyhwYXJ0c1N0YXJ0LmhvdXIgPz8gXCIwXCIsIHBhcnRzU3RhcnQubWludXRlID8/IFwiMFwiKTtcclxuICBjb25zdCBlbmRNaW51dGVzID0gdG9NaW51dGVzKHBhcnRzRW5kLmhvdXIgPz8gXCIwXCIsIHBhcnRzRW5kLm1pbnV0ZSA/PyBcIjBcIik7XHJcblxyXG4gIHJldHVybiBpbnRlcnZhbHMuc29tZSgoW2Zyb20sIHRvXSkgPT4ge1xyXG4gICAgY29uc3QgW2ZoLCBmbV0gPSBmcm9tLnNwbGl0KFwiOlwiKTtcclxuICAgIGNvbnN0IFt0aCwgdG1dID0gdG8uc3BsaXQoXCI6XCIpO1xyXG4gICAgY29uc3QgZnJvbU0gPSB0b01pbnV0ZXMoZmgsIGZtKTtcclxuICAgIGNvbnN0IHRvTSA9IHRvTWludXRlcyh0aCwgdG0pO1xyXG4gICAgcmV0dXJuIHN0YXJ0TWludXRlcyA+PSBmcm9tTSAmJiBlbmRNaW51dGVzIDw9IHRvTTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSh7XHJcbiAgc3RhcnQsXHJcbiAgZW5kLFxyXG4gIGFwcG9pbnRtZW50cyxcclxuICBkdXJhdGlvbk1pbnV0ZXMgPSBERUZBVUxUX1NMT1RfRFVSQVRJT05fTUlOLFxyXG4gIGJ1ZmZlck1pbnV0ZXMgPSAwLFxyXG59OiB7XHJcbiAgc3RhcnQ6IERhdGU7XHJcbiAgZW5kOiBEYXRlO1xyXG4gIGFwcG9pbnRtZW50czogQXBwb2ludG1lbnRSb3dbXTtcclxuICBkdXJhdGlvbk1pbnV0ZXM/OiBudW1iZXI7XHJcbiAgYnVmZmVyTWludXRlcz86IG51bWJlcjtcclxufSkge1xyXG4gIGNvbnN0IHNsb3RzOiB7IHN0YXJ0OiBEYXRlOyBlbmQ6IERhdGUgfVtdID0gW107XHJcbiAgbGV0IGN1cnNvciA9IG5ldyBEYXRlKHN0YXJ0KTtcclxuXHJcbiAgd2hpbGUgKGlzQmVmb3JlKGFkZE1pbnV0ZXMoY3Vyc29yLCBkdXJhdGlvbk1pbnV0ZXMpLCBlbmQpKSB7XHJcbiAgICBjb25zdCBjYW5kaWRhdGVFbmQgPSBhZGRNaW51dGVzKGN1cnNvciwgZHVyYXRpb25NaW51dGVzKTtcclxuICAgIGNvbnN0IG92ZXJsYXBzID0gYXBwb2ludG1lbnRzLnNvbWUoKGFwcHQpID0+IHtcclxuICAgICAgY29uc3QgYXBwdFN0YXJ0ID0gbmV3IERhdGUoYXBwdC5zdGFydF9hdCk7XHJcbiAgICAgIGNvbnN0IGFwcHRFbmQgPSBuZXcgRGF0ZShhcHB0LmVuZF9hdCk7XHJcbiAgICAgIHJldHVybiBjdXJzb3IgPCBhcHB0RW5kICYmIGNhbmRpZGF0ZUVuZCA+IGFwcHRTdGFydDtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghb3ZlcmxhcHMpIHtcclxuICAgICAgc2xvdHMucHVzaCh7IHN0YXJ0OiBuZXcgRGF0ZShjdXJzb3IpLCBlbmQ6IGNhbmRpZGF0ZUVuZCB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjdXJzb3IgPSBhZGRNaW51dGVzKGN1cnNvciwgZHVyYXRpb25NaW51dGVzICsgYnVmZmVyTWludXRlcyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gc2xvdHM7XHJcbn1cclxuIl0sIm5hbWVzIjpbImFkZE1pbnV0ZXMiLCJpc0JlZm9yZSIsIkRFRkFVTFRfU0xPVF9EVVJBVElPTl9NSU4iLCJpc1dpdGhpbkJ1c2luZXNzSG91cnMiLCJvcHRpb25zIiwic3RhcnQiLCJlbmQiLCJidXNpbmVzc0hvdXJzIiwidGltZVpvbmUiLCJmbXQiLCJJbnRsIiwiRGF0ZVRpbWVGb3JtYXQiLCJ3ZWVrZGF5IiwiaG91ciIsIm1pbnV0ZSIsImhvdXIxMiIsInBhcnRzU3RhcnQiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImZvcm1hdFRvUGFydHMiLCJtYXAiLCJwIiwidHlwZSIsInZhbHVlIiwicGFydHNFbmQiLCJkYXlLZXkiLCJzbGljZSIsInRvTG93ZXJDYXNlIiwiaW50ZXJ2YWxzIiwibGVuZ3RoIiwidG9NaW51dGVzIiwiaCIsIm0iLCJOdW1iZXIiLCJzdGFydE1pbnV0ZXMiLCJlbmRNaW51dGVzIiwic29tZSIsImZyb20iLCJ0byIsImZoIiwiZm0iLCJzcGxpdCIsInRoIiwidG0iLCJmcm9tTSIsInRvTSIsImNhbGN1bGF0ZUF2YWlsYWJpbGl0eSIsImFwcG9pbnRtZW50cyIsImR1cmF0aW9uTWludXRlcyIsImJ1ZmZlck1pbnV0ZXMiLCJzbG90cyIsImN1cnNvciIsIkRhdGUiLCJjYW5kaWRhdGVFbmQiLCJvdmVybGFwcyIsImFwcHQiLCJhcHB0U3RhcnQiLCJzdGFydF9hdCIsImFwcHRFbmQiLCJlbmRfYXQiLCJwdXNoIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/scheduling.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/route.ts":
/*!***********************************!*\
  !*** ./src/lib/supabase/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRouteSupabase: () => (/* binding */ getRouteSupabase)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(rsc)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction getRouteSupabase() {\n    return (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__.createRouteHandlerClient)({\n        cookies: next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBdUM7QUFDa0M7QUFHbEUsU0FBU0U7SUFDZCxPQUFPRCx1RkFBd0JBLENBQVc7UUFBRUQsT0FBT0EsbURBQUFBO0lBQUM7QUFDdEQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZ2VuZGFyLWFwcC8uL3NyYy9saWIvc3VwYWJhc2Uvcm91dGUudHM/M2NlNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL2F1dGgtaGVscGVycy1uZXh0anNcIjtcclxuaW1wb3J0IHsgRGF0YWJhc2UgfSBmcm9tIFwiQC90eXBlcy9kYXRhYmFzZVwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJvdXRlU3VwYWJhc2UoKSB7XHJcbiAgcmV0dXJuIGNyZWF0ZVJvdXRlSGFuZGxlckNsaWVudDxEYXRhYmFzZT4oeyBjb29raWVzIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJjb29raWVzIiwiY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50IiwiZ2V0Um91dGVTdXBhYmFzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/service.ts":
/*!*************************************!*\
  !*** ./src/lib/supabase/service.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   serviceClient: () => (/* binding */ serviceClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\nconst url = \"https://oaxielrsiogvnxradtsw.supabase.co\";\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!url || !serviceKey) {\n    console.warn(\"Supabase service client is not fully configured.\");\n}\nconst serviceClient = url && serviceKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, serviceKey, {\n    auth: {\n        persistSession: false\n    }\n}) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFHckQsTUFBTUMsTUFBTUMsMENBQW9DO0FBQ2hELE1BQU1HLGFBQWFILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0FBRXhELElBQUksQ0FBQ0wsT0FBTyxDQUFDSSxZQUFZO0lBQ3ZCRSxRQUFRQyxJQUFJLENBQUM7QUFDZjtBQUVPLE1BQU1DLGdCQUFnQlIsT0FBT0ksYUFDaENMLG1FQUFZQSxDQUFXQyxLQUFLSSxZQUFZO0lBQ3RDSyxNQUFNO1FBQUVDLGdCQUFnQjtJQUFNO0FBQ2hDLEtBQ0EsS0FBSyIsInNvdXJjZXMiOlsid2VicGFjazovL2FnZW5kYXItYXBwLy4vc3JjL2xpYi9zdXBhYmFzZS9zZXJ2aWNlLnRzP2MyMGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xyXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gXCJAL3R5cGVzL2RhdGFiYXNlXCI7XHJcblxyXG5jb25zdCB1cmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkw7XHJcbmNvbnN0IHNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuaWYgKCF1cmwgfHwgIXNlcnZpY2VLZXkpIHtcclxuICBjb25zb2xlLndhcm4oXCJTdXBhYmFzZSBzZXJ2aWNlIGNsaWVudCBpcyBub3QgZnVsbHkgY29uZmlndXJlZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBzZXJ2aWNlQ2xpZW50ID0gdXJsICYmIHNlcnZpY2VLZXlcclxuICA/IGNyZWF0ZUNsaWVudDxEYXRhYmFzZT4odXJsLCBzZXJ2aWNlS2V5LCB7XHJcbiAgICAgIGF1dGg6IHsgcGVyc2lzdFNlc3Npb246IGZhbHNlIH0sXHJcbiAgICB9KVxyXG4gIDogbnVsbDtcclxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwic2VydmljZUNsaWVudCIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/service.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/whatsapp.ts":
/*!*****************************!*\
  !*** ./src/lib/whatsapp.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendTemplateMessage: () => (/* binding */ sendTemplateMessage),\n/* harmony export */   sendTextMessage: () => (/* binding */ sendTextMessage)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\nconst baseUrl = \"https://graph.facebook.com/v18.0\";\nconst templateSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n    language: zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        code: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n    }),\n    components: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any()).optional()\n});\nasync function callWhatsAppAPI({ credentials, path, init }) {\n    const { accessToken, phoneNumberId } = credentials;\n    if (!accessToken || !phoneNumberId) {\n        throw new Error(\"WhatsApp credentials missing\");\n    }\n    const res = await fetch(`${baseUrl}/${phoneNumberId}/${path}`, {\n        ...init,\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${accessToken}`,\n            ...init.headers\n        }\n    });\n    if (!res.ok) {\n        const errorText = await res.text();\n        console.error(`[WhatsApp API Error] Status: ${res.status}, Body: ${errorText}`);\n        throw new Error(`WhatsApp API error: ${res.status} ${errorText}`);\n    }\n    return res.json();\n}\nasync function sendTemplateMessage({ to, template, variables = [], languageCode = \"es\", nameOverride, credentials }) {\n    const templateName = nameOverride ?? template;\n    const parsedTemplate = templateSchema.parse({\n        name: templateName,\n        language: {\n            code: languageCode\n        }\n    });\n    return callWhatsAppAPI({\n        credentials,\n        path: \"messages\",\n        init: {\n            method: \"POST\",\n            body: JSON.stringify({\n                messaging_product: \"whatsapp\",\n                to,\n                type: \"template\",\n                template: {\n                    ...parsedTemplate,\n                    components: [\n                        {\n                            type: \"body\",\n                            parameters: variables.map((value)=>({\n                                    type: \"text\",\n                                    text: value\n                                }))\n                        }\n                    ]\n                }\n            })\n        }\n    });\n}\nasync function sendTextMessage({ to, text, credentials }) {\n    return callWhatsAppAPI({\n        credentials,\n        path: \"messages\",\n        init: {\n            method: \"POST\",\n            body: JSON.stringify({\n                messaging_product: \"whatsapp\",\n                to,\n                type: \"text\",\n                text: {\n                    body: text\n                }\n            })\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3doYXRzYXBwLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3QjtBQUd4QixNQUFNQyxVQUFVO0FBRWhCLE1BQU1DLGlCQUFpQkYsdUNBQVEsQ0FBQztJQUM5QkksTUFBTUosdUNBQVE7SUFDZE0sVUFBVU4sdUNBQVEsQ0FBQztRQUFFTyxNQUFNUCx1Q0FBUTtJQUFHO0lBQ3RDUSxZQUFZUixzQ0FBTyxDQUFDQSxvQ0FBSyxJQUFJVyxRQUFRO0FBQ3ZDO0FBRUEsZUFBZUMsZ0JBQWdCLEVBQzdCQyxXQUFXLEVBQ1hDLElBQUksRUFDSkMsSUFBSSxFQUtMO0lBQ0MsTUFBTSxFQUFFQyxXQUFXLEVBQUVDLGFBQWEsRUFBRSxHQUFHSjtJQUV2QyxJQUFJLENBQUNHLGVBQWUsQ0FBQ0MsZUFBZTtRQUNsQyxNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFFQSxNQUFNQyxNQUFNLE1BQU1DLE1BQU0sQ0FBQyxFQUFFbkIsUUFBUSxDQUFDLEVBQUVnQixjQUFjLENBQUMsRUFBRUgsS0FBSyxDQUFDLEVBQUU7UUFDN0QsR0FBR0MsSUFBSTtRQUNQTSxTQUFTO1lBQ1AsZ0JBQWdCO1lBQ2hCQyxlQUFlLENBQUMsT0FBTyxFQUFFTixZQUFZLENBQUM7WUFDdEMsR0FBR0QsS0FBS00sT0FBTztRQUNqQjtJQUNGO0lBRUEsSUFBSSxDQUFDRixJQUFJSSxFQUFFLEVBQUU7UUFDWCxNQUFNQyxZQUFZLE1BQU1MLElBQUlNLElBQUk7UUFDaENDLFFBQVFDLEtBQUssQ0FBQyxDQUFDLDZCQUE2QixFQUFFUixJQUFJUyxNQUFNLENBQUMsUUFBUSxFQUFFSixVQUFVLENBQUM7UUFDOUUsTUFBTSxJQUFJTixNQUFNLENBQUMsb0JBQW9CLEVBQUVDLElBQUlTLE1BQU0sQ0FBQyxDQUFDLEVBQUVKLFVBQVUsQ0FBQztJQUNsRTtJQUVBLE9BQU9MLElBQUlVLElBQUk7QUFDakI7QUFFTyxlQUFlQyxvQkFBb0IsRUFDeENDLEVBQUUsRUFDRkMsUUFBUSxFQUNSQyxZQUFZLEVBQUUsRUFDZEMsZUFBZSxJQUFJLEVBQ25CQyxZQUFZLEVBQ1p0QixXQUFXLEVBUVo7SUFDQyxNQUFNdUIsZUFBZUQsZ0JBQWdCSDtJQUNyQyxNQUFNSyxpQkFBaUJuQyxlQUFlb0MsS0FBSyxDQUFDO1FBQzFDbEMsTUFBTWdDO1FBQ045QixVQUFVO1lBQUVDLE1BQU0yQjtRQUFhO0lBQ2pDO0lBRUEsT0FBT3RCLGdCQUFnQjtRQUNyQkM7UUFDQUMsTUFBTTtRQUNOQyxNQUFNO1lBQ0p3QixRQUFRO1lBQ1JDLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztnQkFDbkJDLG1CQUFtQjtnQkFDbkJaO2dCQUNBYSxNQUFNO2dCQUNOWixVQUFVO29CQUNSLEdBQUdLLGNBQWM7b0JBQ2pCN0IsWUFBWTt3QkFDVjs0QkFDRW9DLE1BQU07NEJBQ05DLFlBQVlaLFVBQVVhLEdBQUcsQ0FBQyxDQUFDQyxRQUFXO29DQUFFSCxNQUFNO29DQUFRbkIsTUFBTXNCO2dDQUFNO3dCQUNwRTtxQkFDRDtnQkFDSDtZQUNGO1FBQ0Y7SUFDRjtBQUNGO0FBRU8sZUFBZUMsZ0JBQWdCLEVBQ3BDakIsRUFBRSxFQUNGTixJQUFJLEVBQ0paLFdBQVcsRUFLWjtJQUNDLE9BQU9ELGdCQUFnQjtRQUNyQkM7UUFDQUMsTUFBTTtRQUNOQyxNQUFNO1lBQ0p3QixRQUFRO1lBQ1JDLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztnQkFDbkJDLG1CQUFtQjtnQkFDbkJaO2dCQUNBYSxNQUFNO2dCQUNObkIsTUFBTTtvQkFBRWUsTUFBTWY7Z0JBQUs7WUFDckI7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZ2VuZGFyLWFwcC8uL3NyYy9saWIvd2hhdHNhcHAudHM/ZGY5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xyXG5pbXBvcnQgdHlwZSB7IFdoYXRzQXBwQ3JlZGVudGlhbHMgfSBmcm9tIFwiQC9zZXJ2ZXIvd2hhdHNhcHAtY29uZmlnXCI7XHJcblxyXG5jb25zdCBiYXNlVXJsID0gXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTguMFwiO1xyXG5cclxuY29uc3QgdGVtcGxhdGVTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgbmFtZTogei5zdHJpbmcoKSxcclxuICBsYW5ndWFnZTogei5vYmplY3QoeyBjb2RlOiB6LnN0cmluZygpIH0pLFxyXG4gIGNvbXBvbmVudHM6IHouYXJyYXkoei5hbnkoKSkub3B0aW9uYWwoKSxcclxufSk7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjYWxsV2hhdHNBcHBBUEkoe1xyXG4gIGNyZWRlbnRpYWxzLFxyXG4gIHBhdGgsXHJcbiAgaW5pdCxcclxufToge1xyXG4gIGNyZWRlbnRpYWxzOiBXaGF0c0FwcENyZWRlbnRpYWxzO1xyXG4gIHBhdGg6IHN0cmluZztcclxuICBpbml0OiBSZXF1ZXN0SW5pdDtcclxufSkge1xyXG4gIGNvbnN0IHsgYWNjZXNzVG9rZW4sIHBob25lTnVtYmVySWQgfSA9IGNyZWRlbnRpYWxzO1xyXG5cclxuICBpZiAoIWFjY2Vzc1Rva2VuIHx8ICFwaG9uZU51bWJlcklkKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJXaGF0c0FwcCBjcmVkZW50aWFscyBtaXNzaW5nXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vJHtwaG9uZU51bWJlcklkfS8ke3BhdGh9YCwge1xyXG4gICAgLi4uaW5pdCxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLFxyXG4gICAgICAuLi5pbml0LmhlYWRlcnMsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICBpZiAoIXJlcy5vaykge1xyXG4gICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzLnRleHQoKTtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtXaGF0c0FwcCBBUEkgRXJyb3JdIFN0YXR1czogJHtyZXMuc3RhdHVzfSwgQm9keTogJHtlcnJvclRleHR9YCk7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFdoYXRzQXBwIEFQSSBlcnJvcjogJHtyZXMuc3RhdHVzfSAke2Vycm9yVGV4dH1gKTtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXMuanNvbigpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZFRlbXBsYXRlTWVzc2FnZSh7XHJcbiAgdG8sXHJcbiAgdGVtcGxhdGUsXHJcbiAgdmFyaWFibGVzID0gW10sXHJcbiAgbGFuZ3VhZ2VDb2RlID0gXCJlc1wiLFxyXG4gIG5hbWVPdmVycmlkZSxcclxuICBjcmVkZW50aWFscyxcclxufToge1xyXG4gIHRvOiBzdHJpbmc7XHJcbiAgdGVtcGxhdGU6IHN0cmluZztcclxuICB2YXJpYWJsZXM/OiBzdHJpbmdbXTtcclxuICBsYW5ndWFnZUNvZGU/OiBzdHJpbmc7XHJcbiAgbmFtZU92ZXJyaWRlPzogc3RyaW5nIHwgbnVsbDtcclxuICBjcmVkZW50aWFsczogV2hhdHNBcHBDcmVkZW50aWFscztcclxufSkge1xyXG4gIGNvbnN0IHRlbXBsYXRlTmFtZSA9IG5hbWVPdmVycmlkZSA/PyB0ZW1wbGF0ZTtcclxuICBjb25zdCBwYXJzZWRUZW1wbGF0ZSA9IHRlbXBsYXRlU2NoZW1hLnBhcnNlKHtcclxuICAgIG5hbWU6IHRlbXBsYXRlTmFtZSxcclxuICAgIGxhbmd1YWdlOiB7IGNvZGU6IGxhbmd1YWdlQ29kZSB9LFxyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FsbFdoYXRzQXBwQVBJKHtcclxuICAgIGNyZWRlbnRpYWxzLFxyXG4gICAgcGF0aDogXCJtZXNzYWdlc1wiLFxyXG4gICAgaW5pdDoge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbWVzc2FnaW5nX3Byb2R1Y3Q6IFwid2hhdHNhcHBcIixcclxuICAgICAgICB0byxcclxuICAgICAgICB0eXBlOiBcInRlbXBsYXRlXCIsXHJcbiAgICAgICAgdGVtcGxhdGU6IHtcclxuICAgICAgICAgIC4uLnBhcnNlZFRlbXBsYXRlLFxyXG4gICAgICAgICAgY29tcG9uZW50czogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgdHlwZTogXCJib2R5XCIsXHJcbiAgICAgICAgICAgICAgcGFyYW1ldGVyczogdmFyaWFibGVzLm1hcCgodmFsdWUpID0+ICh7IHR5cGU6IFwidGV4dFwiLCB0ZXh0OiB2YWx1ZSB9KSksXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pLFxyXG4gICAgfSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRUZXh0TWVzc2FnZSh7XHJcbiAgdG8sXHJcbiAgdGV4dCxcclxuICBjcmVkZW50aWFscyxcclxufToge1xyXG4gIHRvOiBzdHJpbmc7XHJcbiAgdGV4dDogc3RyaW5nO1xyXG4gIGNyZWRlbnRpYWxzOiBXaGF0c0FwcENyZWRlbnRpYWxzO1xyXG59KSB7XHJcbiAgcmV0dXJuIGNhbGxXaGF0c0FwcEFQSSh7XHJcbiAgICBjcmVkZW50aWFscyxcclxuICAgIHBhdGg6IFwibWVzc2FnZXNcIixcclxuICAgIGluaXQ6IHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG1lc3NhZ2luZ19wcm9kdWN0OiBcIndoYXRzYXBwXCIsXHJcbiAgICAgICAgdG8sXHJcbiAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXHJcbiAgICAgICAgdGV4dDogeyBib2R5OiB0ZXh0IH0sXHJcbiAgICAgIH0pLFxyXG4gICAgfSxcclxuICB9KTtcclxufVxyXG4iXSwibmFtZXMiOlsieiIsImJhc2VVcmwiLCJ0ZW1wbGF0ZVNjaGVtYSIsIm9iamVjdCIsIm5hbWUiLCJzdHJpbmciLCJsYW5ndWFnZSIsImNvZGUiLCJjb21wb25lbnRzIiwiYXJyYXkiLCJhbnkiLCJvcHRpb25hbCIsImNhbGxXaGF0c0FwcEFQSSIsImNyZWRlbnRpYWxzIiwicGF0aCIsImluaXQiLCJhY2Nlc3NUb2tlbiIsInBob25lTnVtYmVySWQiLCJFcnJvciIsInJlcyIsImZldGNoIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJvayIsImVycm9yVGV4dCIsInRleHQiLCJjb25zb2xlIiwiZXJyb3IiLCJzdGF0dXMiLCJqc29uIiwic2VuZFRlbXBsYXRlTWVzc2FnZSIsInRvIiwidGVtcGxhdGUiLCJ2YXJpYWJsZXMiLCJsYW5ndWFnZUNvZGUiLCJuYW1lT3ZlcnJpZGUiLCJ0ZW1wbGF0ZU5hbWUiLCJwYXJzZWRUZW1wbGF0ZSIsInBhcnNlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtZXNzYWdpbmdfcHJvZHVjdCIsInR5cGUiLCJwYXJhbWV0ZXJzIiwibWFwIiwidmFsdWUiLCJzZW5kVGV4dE1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/whatsapp.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/appointments/createAppointment.ts":
/*!******************************************************!*\
  !*** ./src/server/appointments/createAppointment.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppointmentCreationError: () => (/* binding */ AppointmentCreationError),\n/* harmony export */   createAppointmentForTenant: () => (/* binding */ createAppointmentForTenant)\n/* harmony export */ });\n/* harmony import */ var _barrel_optimize_names_addMinutes_date_fns__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=addMinutes!=!date-fns */ \"(rsc)/./node_modules/date-fns/addMinutes.mjs\");\n/* harmony import */ var _lib_scheduling__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/scheduling */ \"(rsc)/./src/lib/scheduling.ts\");\n/* harmony import */ var _lib_whatsapp__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/whatsapp */ \"(rsc)/./src/lib/whatsapp.ts\");\n/* harmony import */ var _lib_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/messages */ \"(rsc)/./src/lib/messages.ts\");\n/* harmony import */ var _server_whatsapp_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/server/whatsapp-config */ \"(rsc)/./src/server/whatsapp-config.ts\");\n/* harmony import */ var _lib_logging__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/logging */ \"(rsc)/./src/lib/logging.ts\");\n\n\n\n\n\n\nclass AppointmentCreationError extends Error {\n    constructor(message, status = 400){\n        super(message);\n        this.status = status;\n    }\n}\nasync function createAppointmentForTenant(options) {\n    const { db, tenantId, input, sendNotifications = true } = options;\n    const { patient, phone, start, duration, serviceName, notes, locationId: rawLocationId, serviceId, providerId } = input;\n    if (!patient || !phone || !start) {\n        throw new AppointmentCreationError(\"Missing required fields\", 400);\n    }\n    const startAt = new Date(start);\n    if (!Number.isFinite(startAt.getTime())) {\n        throw new AppointmentCreationError(\"Invalid start date\", 400);\n    }\n    // Improved phone normalization: Remove spaces/dashes. Ensure '+' prefix.\n    const cleanedPhone = phone.trim().replace(/[\\s-]/g, \"\");\n    const normalizedPhone = cleanedPhone.startsWith(\"+\") ? cleanedPhone : `+${cleanedPhone}`;\n    let resolvedService = null;\n    if (serviceId) {\n        const { data: serviceRow, error: serviceError } = await db.from(\"agenda_services\").select(\"id, tenant_id, name, description, duration_minutes, price_minor_units, currency, color, active\").eq(\"tenant_id\", tenantId).eq(\"id\", serviceId).maybeSingle();\n        if (serviceError || !serviceRow) {\n            throw new AppointmentCreationError(\"Servicio inv\\xe1lido\", 400);\n        }\n        if (!serviceRow.active) {\n            throw new AppointmentCreationError(\"El servicio est\\xe1 pausado\", 400);\n        }\n        resolvedService = serviceRow;\n    }\n    let resolvedProvider = null;\n    if (providerId) {\n        const { data: providerRow, error: providerError } = await db.from(\"agenda_providers\").select(\"id, tenant_id, full_name, active, default_location_id, metadata\").eq(\"tenant_id\", tenantId).eq(\"id\", providerId).maybeSingle();\n        if (providerError || !providerRow) {\n            throw new AppointmentCreationError(\"Profesional inv\\xe1lido\", 400);\n        }\n        if (!providerRow.active) {\n            throw new AppointmentCreationError(\"El profesional est\\xe1 pausado\", 400);\n        }\n        resolvedProvider = providerRow;\n    }\n    const durationSource = Number(duration ?? resolvedService?.duration_minutes ?? 30);\n    const durationMinutes = Math.max(5, Number.isFinite(durationSource) ? durationSource : 30);\n    const endAt = (0,_barrel_optimize_names_addMinutes_date_fns__WEBPACK_IMPORTED_MODULE_5__.addMinutes)(startAt, durationMinutes);\n    const { data: existingPatient } = await db.from(\"agenda_patients\").select(\"id\").eq(\"tenant_id\", tenantId).eq(\"phone_e164\", normalizedPhone).maybeSingle();\n    let patientId = existingPatient?.id ?? null;\n    if (!patientId) {\n        const insertPayload = {\n            tenant_id: tenantId,\n            full_name: patient,\n            phone_e164: normalizedPhone,\n            opt_out: false\n        };\n        const { data: inserted, error: patientError } = await db.from(\"agenda_patients\").insert(insertPayload).select(\"id\").single();\n        if (patientError) {\n            throw new AppointmentCreationError(patientError.message, 400);\n        }\n        patientId = inserted.id;\n    } else {\n        await db.from(\"agenda_patients\").update({\n            full_name: patient\n        }).eq(\"id\", patientId).eq(\"tenant_id\", tenantId);\n    }\n    let locationId = rawLocationId ?? resolvedProvider?.default_location_id ?? null;\n    let locationName = \"Consultorio\";\n    let locationTimezone = \"America/Argentina/Buenos_Aires\";\n    let bufferMinutes = 0;\n    let businessHours = {};\n    const assignLocation = (row)=>{\n        if (row) {\n            locationId = row.id;\n            locationName = row.name;\n            locationTimezone = row.timezone;\n            bufferMinutes = row.buffer_minutes ?? 0;\n            businessHours = row.business_hours ?? {};\n        } else {\n            locationId = null;\n        }\n    };\n    if (locationId) {\n        const { data: locationRow } = await db.from(\"agenda_locations\").select(\"id, name, timezone, buffer_minutes, business_hours\").eq(\"tenant_id\", tenantId).eq(\"id\", locationId).maybeSingle();\n        assignLocation(locationRow ?? null);\n    }\n    if (!locationId) {\n        const { data: fallback } = await db.from(\"agenda_locations\").select(\"id, name, timezone, buffer_minutes, business_hours\").eq(\"tenant_id\", tenantId).order(\"name\", {\n            ascending: true\n        }).limit(1).maybeSingle();\n        assignLocation(fallback ?? null);\n    }\n    if (!locationId) {\n        throw new AppointmentCreationError(\"Debe crear una ubicaci\\xf3n primero\", 400);\n    }\n    // 1. Check Provider Override\n    if (resolvedProvider) {\n        const provSchedule = resolvedProvider.metadata?.schedule;\n        if (provSchedule && Object.keys(provSchedule).length > 0) {\n            businessHours = provSchedule;\n        }\n    }\n    // 2. Fallback default hours if empty (Matches getSlots behavior)\n    if (Object.keys(businessHours).length === 0) {\n        businessHours = {\n            mon: [\n                [\n                    \"09:00\",\n                    \"18:00\"\n                ]\n            ],\n            tue: [\n                [\n                    \"09:00\",\n                    \"18:00\"\n                ]\n            ],\n            wed: [\n                [\n                    \"09:00\",\n                    \"18:00\"\n                ]\n            ],\n            thu: [\n                [\n                    \"09:00\",\n                    \"18:00\"\n                ]\n            ],\n            fri: [\n                [\n                    \"09:00\",\n                    \"18:00\"\n                ]\n            ]\n        };\n    }\n    const validHours = (0,_lib_scheduling__WEBPACK_IMPORTED_MODULE_0__.isWithinBusinessHours)({\n        start: startAt,\n        end: endAt,\n        businessHours,\n        timeZone: locationTimezone\n    });\n    if (!validHours) {\n        const debugInfo = `Start: ${startAt.toISOString()}, LocTZ: ${locationTimezone}, LocalDay: ${new Intl.DateTimeFormat(\"en-US\", {\n            timeZone: locationTimezone,\n            weekday: \"short\",\n            hour: \"numeric\"\n        }).format(startAt)}`;\n        console.error(`[AppointmentError] Outside Business Hours. ${debugInfo}`);\n        throw new AppointmentCreationError(`Fuera del horario de atencin (${debugInfo})`, 400);\n    }\n    const conflictWindowStart = (0,_barrel_optimize_names_addMinutes_date_fns__WEBPACK_IMPORTED_MODULE_5__.addMinutes)(startAt, -bufferMinutes);\n    const conflictWindowEnd = (0,_barrel_optimize_names_addMinutes_date_fns__WEBPACK_IMPORTED_MODULE_5__.addMinutes)(endAt, bufferMinutes);\n    let conflictQuery = db.from(\"agenda_appointments\").select(\"id\").eq(\"tenant_id\", tenantId).eq(\"location_id\", locationId).neq(\"status\", \"canceled\").lt(\"start_at\", conflictWindowEnd.toISOString()).gt(\"end_at\", conflictWindowStart.toISOString());\n    /*\r\n  // Disabled until DB migration is applied\r\n  if (resolvedProvider?.id) {\r\n    conflictQuery = conflictQuery.or(`provider_id.eq.${resolvedProvider.id},provider_id.is.null`);\r\n  }\r\n  */ const { data: conflicts, error: conflictError } = await conflictQuery.limit(1);\n    if (conflictError) {\n        throw new AppointmentCreationError(conflictError.message, 400);\n    }\n    if (conflicts && conflicts.length > 0) {\n        throw new AppointmentCreationError(\"Ya hay un turno en ese horario\", 409);\n    }\n    const serviceSnapshot = resolvedService ? {\n        id: resolvedService.id,\n        name: resolvedService.name,\n        description: resolvedService.description,\n        duration_minutes: resolvedService.duration_minutes,\n        price_minor_units: resolvedService.price_minor_units,\n        currency: resolvedService.currency,\n        color: resolvedService.color\n    } : null;\n    const normalizedServiceName = resolvedService?.name ?? (serviceName?.trim().length ? serviceName?.trim() : null);\n    const appointmentInsert = {\n        tenant_id: tenantId,\n        location_id: locationId,\n        patient_id: patientId,\n        start_at: startAt.toISOString(),\n        end_at: endAt.toISOString(),\n        status: \"pending\",\n        // service_id: resolvedService?.id ?? null, // DISABLED: DB schema cache error\n        // provider_id: resolvedProvider?.id ?? null, // DISABLED: DB column missing\n        service_name: normalizedServiceName,\n        // service_snapshot: serviceSnapshot, // DISABLED: DB schema cache error\n        internal_notes: notes ?? null\n    };\n    const { error: apptError, data: appt } = await db.from(\"agenda_appointments\").insert(appointmentInsert).select(\"id, start_at, end_at, status\").single();\n    if (apptError) {\n        throw new AppointmentCreationError(apptError.message, 400);\n    }\n    if (sendNotifications) {\n        try {\n            const [credentials, templateMap] = await Promise.all([\n                (0,_server_whatsapp_config__WEBPACK_IMPORTED_MODULE_3__.getWhatsAppIntegrationByTenant)(db, tenantId),\n                (0,_server_whatsapp_config__WEBPACK_IMPORTED_MODULE_3__.getTenantTemplateMap)(db, tenantId)\n            ]);\n            if (!credentials) {\n                // Critical error for auditing\n                console.error(`[AppointmentCreation] Missing WhatsApp credentials for tenant ${tenantId}. Message NOT sent.`);\n                throw new Error(\"WhatsApp integration missing for tenant\");\n            }\n            // TEMPORARY FALLBACK: Use hello_world if custom template is not ready.\n            let templateToSend = templateOverride || _lib_messages__WEBPACK_IMPORTED_MODULE_2__.TEMPLATE_NAMES.appointmentCreated;\n            let variablesToSend = [\n                patient,\n                startAt.toLocaleDateString(\"es-AR\"),\n                startAt.toLocaleTimeString(\"es-AR\", {\n                    hour: \"2-digit\",\n                    minute: \"2-digit\"\n                }),\n                locationName,\n                locationName // Using location as the 5th variable just in case\n            ];\n            // Force hello_world just for this test while Meta approves the real one\n            // Uncomment the next line to test NOW with the generic template\n            templateToSend = \"hello_world\";\n            variablesToSend = undefined;\n            console.log(`[AppointmentCreation] Sending WhatsApp to ${normalizedPhone} (Template: ${templateToSend})`);\n            await (0,_lib_whatsapp__WEBPACK_IMPORTED_MODULE_1__.sendTemplateMessage)({\n                to: normalizedPhone,\n                template: templateToSend,\n                variables: variablesToSend,\n                nameOverride: null,\n                credentials,\n                languageCode: \"en_US\" // hello_world usually requires en_US\n            });\n            await db.from(\"agenda_message_log\").insert({\n                tenant_id: tenantId,\n                patient_id: patientId,\n                appointment_id: appt.id,\n                direction: \"out\",\n                type: _lib_messages__WEBPACK_IMPORTED_MODULE_2__.TEMPLATE_NAMES.appointmentCreated,\n                status: \"sent\"\n            });\n            (0,_lib_logging__WEBPACK_IMPORTED_MODULE_4__.logInfo)(\"appointment.created_notification_sent\", {\n                tenant_id: tenantId,\n                appointment_id: appt.id,\n                patient_id: patientId\n            });\n        } catch (err) {\n            (0,_lib_logging__WEBPACK_IMPORTED_MODULE_4__.logError)(\"appointment.created_notification_failed\", {\n                tenant_id: tenantId,\n                appointment_id: appt.id,\n                error: err?.message ?? String(err)\n            });\n        }\n    }\n    return {\n        appointment: appt\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL2FwcG9pbnRtZW50cy9jcmVhdGVBcHBvaW50bWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzQztBQUdtQjtBQUNKO0FBQ0w7QUFDZ0Q7QUFDOUM7QUE4QjNDLE1BQU1RLGlDQUFpQ0M7SUFHNUNDLFlBQVlDLE9BQWUsRUFBRUMsU0FBUyxHQUFHLENBQUU7UUFDekMsS0FBSyxDQUFDRDtRQUNOLElBQUksQ0FBQ0MsTUFBTSxHQUFHQTtJQUNoQjtBQUNGO0FBRU8sZUFBZUMsMkJBQTJCQyxPQUtoRDtJQUNDLE1BQU0sRUFBRUMsRUFBRSxFQUFFQyxRQUFRLEVBQUVDLEtBQUssRUFBRUMsb0JBQW9CLElBQUksRUFBRSxHQUFHSjtJQUMxRCxNQUFNLEVBQUVLLE9BQU8sRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRUMsV0FBVyxFQUFFQyxLQUFLLEVBQUVDLFlBQVlDLGFBQWEsRUFBRUMsU0FBUyxFQUFFQyxVQUFVLEVBQUUsR0FBR1g7SUFFbEgsSUFBSSxDQUFDRSxXQUFXLENBQUNDLFNBQVMsQ0FBQ0MsT0FBTztRQUNoQyxNQUFNLElBQUliLHlCQUF5QiwyQkFBMkI7SUFDaEU7SUFFQSxNQUFNcUIsVUFBVSxJQUFJQyxLQUFLVDtJQUN6QixJQUFJLENBQUNVLE9BQU9DLFFBQVEsQ0FBQ0gsUUFBUUksT0FBTyxLQUFLO1FBQ3ZDLE1BQU0sSUFBSXpCLHlCQUF5QixzQkFBc0I7SUFDM0Q7SUFFQSx5RUFBeUU7SUFDekUsTUFBTTBCLGVBQWVkLE1BQU1lLElBQUksR0FBR0MsT0FBTyxDQUFDLFVBQVU7SUFDcEQsTUFBTUMsa0JBQWtCSCxhQUFhSSxVQUFVLENBQUMsT0FBT0osZUFBZSxDQUFDLENBQUMsRUFBRUEsYUFBYSxDQUFDO0lBRXhGLElBQUlLLGtCQUF3QztJQUM1QyxJQUFJWixXQUFXO1FBQ2IsTUFBTSxFQUFFYSxNQUFNQyxVQUFVLEVBQUVDLE9BQU9DLFlBQVksRUFBRSxHQUFHLE1BQU01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QjFGLEVBQUU7Z0JBQzNDbEIsT0FBTyxLQUFnQi9CLFdBQVcrSSxPQUFPRDtZQUMzQztRQUNGO0lBQ0Y7SUFFQSxPQUFPO1FBQUVFLGFBQWF4QjtJQUFLO0FBQzdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbmRhci1hcHAvLi9zcmMvc2VydmVyL2FwcG9pbnRtZW50cy9jcmVhdGVBcHBvaW50bWVudC50cz9lYTJjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFkZE1pbnV0ZXMgfSBmcm9tIFwiZGF0ZS1mbnNcIjtcclxuaW1wb3J0IHsgU3VwYWJhc2VDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XHJcbmltcG9ydCB7IERhdGFiYXNlIH0gZnJvbSBcIkAvdHlwZXMvZGF0YWJhc2VcIjtcclxuaW1wb3J0IHsgaXNXaXRoaW5CdXNpbmVzc0hvdXJzIH0gZnJvbSBcIkAvbGliL3NjaGVkdWxpbmdcIjtcclxuaW1wb3J0IHsgc2VuZFRlbXBsYXRlTWVzc2FnZSB9IGZyb20gXCJAL2xpYi93aGF0c2FwcFwiO1xyXG5pbXBvcnQgeyBURU1QTEFURV9OQU1FUyB9IGZyb20gXCJAL2xpYi9tZXNzYWdlc1wiO1xyXG5pbXBvcnQgeyBnZXRUZW5hbnRUZW1wbGF0ZU1hcCwgZ2V0V2hhdHNBcHBJbnRlZ3JhdGlvbkJ5VGVuYW50IH0gZnJvbSBcIkAvc2VydmVyL3doYXRzYXBwLWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBsb2dFcnJvciwgbG9nSW5mbyB9IGZyb20gXCJAL2xpYi9sb2dnaW5nXCI7XHJcblxyXG50eXBlIFBhdGllbnRSb3cgPSBEYXRhYmFzZVtcInB1YmxpY1wiXVtcIlRhYmxlc1wiXVtcImFnZW5kYV9wYXRpZW50c1wiXVtcIlJvd1wiXTtcclxudHlwZSBMb2NhdGlvblJvdyA9IERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX2xvY2F0aW9uc1wiXVtcIlJvd1wiXTtcclxudHlwZSBBcHBvaW50bWVudEluc2VydCA9IERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX2FwcG9pbnRtZW50c1wiXVtcIkluc2VydFwiXTtcclxudHlwZSBBcHBvaW50bWVudFJvdyA9IERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX2FwcG9pbnRtZW50c1wiXVtcIlJvd1wiXTtcclxudHlwZSBTZXJ2aWNlUm93ID0gRGF0YWJhc2VbXCJwdWJsaWNcIl1bXCJUYWJsZXNcIl1bXCJhZ2VuZGFfc2VydmljZXNcIl1bXCJSb3dcIl07XHJcbnR5cGUgUHJvdmlkZXJSb3cgPSBEYXRhYmFzZVtcInB1YmxpY1wiXVtcIlRhYmxlc1wiXVtcImFnZW5kYV9wcm92aWRlcnNcIl1bXCJSb3dcIl07XHJcblxyXG50eXBlIFNlcnZpY2VMb29rdXAgPSBQaWNrPFxyXG4gIFNlcnZpY2VSb3csXHJcbiAgXCJpZFwiIHwgXCJuYW1lXCIgfCBcImRlc2NyaXB0aW9uXCIgfCBcImR1cmF0aW9uX21pbnV0ZXNcIiB8IFwicHJpY2VfbWlub3JfdW5pdHNcIiB8IFwiY3VycmVuY3lcIiB8IFwiY29sb3JcIiB8IFwiYWN0aXZlXCJcclxuPjtcclxuXHJcbnR5cGUgUHJvdmlkZXJMb29rdXAgPSBQaWNrPFByb3ZpZGVyUm93LCBcImlkXCIgfCBcInRlbmFudF9pZFwiIHwgXCJmdWxsX25hbWVcIiB8IFwiYWN0aXZlXCIgfCBcImRlZmF1bHRfbG9jYXRpb25faWRcIiB8IFwibWV0YWRhdGFcIj47XHJcblxyXG50eXBlIExvY2F0aW9uTG9va3VwID0gUGljazxMb2NhdGlvblJvdywgXCJpZFwiIHwgXCJuYW1lXCIgfCBcInRpbWV6b25lXCIgfCBcImJ1ZmZlcl9taW51dGVzXCIgfCBcImJ1c2luZXNzX2hvdXJzXCI+O1xyXG5cclxuZXhwb3J0IHR5cGUgQXBwb2ludG1lbnRDcmVhdGlvbklucHV0ID0ge1xyXG4gIHBhdGllbnQ6IHN0cmluZztcclxuICBwaG9uZTogc3RyaW5nO1xyXG4gIHN0YXJ0OiBzdHJpbmc7XHJcbiAgZHVyYXRpb24/OiBudW1iZXI7XHJcbiAgc2VydmljZU5hbWU/OiBzdHJpbmcgfCBudWxsO1xyXG4gIG5vdGVzPzogc3RyaW5nIHwgbnVsbDtcclxuICBsb2NhdGlvbklkPzogc3RyaW5nIHwgbnVsbDtcclxuICBzZXJ2aWNlSWQ/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHByb3ZpZGVySWQ/OiBzdHJpbmcgfCBudWxsO1xyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvciBleHRlbmRzIEVycm9yIHtcclxuICBzdGF0dXM6IG51bWJlcjtcclxuXHJcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBzdGF0dXMgPSA0MDApIHtcclxuICAgIHN1cGVyKG1lc3NhZ2UpO1xyXG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwb2ludG1lbnRGb3JUZW5hbnQob3B0aW9uczoge1xyXG4gIGRiOiBTdXBhYmFzZUNsaWVudDxEYXRhYmFzZT47XHJcbiAgdGVuYW50SWQ6IHN0cmluZztcclxuICBpbnB1dDogQXBwb2ludG1lbnRDcmVhdGlvbklucHV0O1xyXG4gIHNlbmROb3RpZmljYXRpb25zPzogYm9vbGVhbjtcclxufSkge1xyXG4gIGNvbnN0IHsgZGIsIHRlbmFudElkLCBpbnB1dCwgc2VuZE5vdGlmaWNhdGlvbnMgPSB0cnVlIH0gPSBvcHRpb25zO1xyXG4gIGNvbnN0IHsgcGF0aWVudCwgcGhvbmUsIHN0YXJ0LCBkdXJhdGlvbiwgc2VydmljZU5hbWUsIG5vdGVzLCBsb2NhdGlvbklkOiByYXdMb2NhdGlvbklkLCBzZXJ2aWNlSWQsIHByb3ZpZGVySWQgfSA9IGlucHV0O1xyXG5cclxuICBpZiAoIXBhdGllbnQgfHwgIXBob25lIHx8ICFzdGFydCkge1xyXG4gICAgdGhyb3cgbmV3IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcihcIk1pc3NpbmcgcmVxdWlyZWQgZmllbGRzXCIsIDQwMCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzdGFydEF0ID0gbmV3IERhdGUoc3RhcnQpO1xyXG4gIGlmICghTnVtYmVyLmlzRmluaXRlKHN0YXJ0QXQuZ2V0VGltZSgpKSkge1xyXG4gICAgdGhyb3cgbmV3IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcihcIkludmFsaWQgc3RhcnQgZGF0ZVwiLCA0MDApO1xyXG4gIH1cclxuXHJcbiAgLy8gSW1wcm92ZWQgcGhvbmUgbm9ybWFsaXphdGlvbjogUmVtb3ZlIHNwYWNlcy9kYXNoZXMuIEVuc3VyZSAnKycgcHJlZml4LlxyXG4gIGNvbnN0IGNsZWFuZWRQaG9uZSA9IHBob25lLnRyaW0oKS5yZXBsYWNlKC9bXFxzLV0vZywgXCJcIik7XHJcbiAgY29uc3Qgbm9ybWFsaXplZFBob25lID0gY2xlYW5lZFBob25lLnN0YXJ0c1dpdGgoXCIrXCIpID8gY2xlYW5lZFBob25lIDogYCske2NsZWFuZWRQaG9uZX1gO1xyXG5cclxuICBsZXQgcmVzb2x2ZWRTZXJ2aWNlOiBTZXJ2aWNlTG9va3VwIHwgbnVsbCA9IG51bGw7XHJcbiAgaWYgKHNlcnZpY2VJZCkge1xyXG4gICAgY29uc3QgeyBkYXRhOiBzZXJ2aWNlUm93LCBlcnJvcjogc2VydmljZUVycm9yIH0gPSBhd2FpdCBkYlxyXG4gICAgICAuZnJvbShcImFnZW5kYV9zZXJ2aWNlc1wiKVxyXG4gICAgICAuc2VsZWN0KFwiaWQsIHRlbmFudF9pZCwgbmFtZSwgZGVzY3JpcHRpb24sIGR1cmF0aW9uX21pbnV0ZXMsIHByaWNlX21pbm9yX3VuaXRzLCBjdXJyZW5jeSwgY29sb3IsIGFjdGl2ZVwiKVxyXG4gICAgICAuZXEoXCJ0ZW5hbnRfaWRcIiwgdGVuYW50SWQpXHJcbiAgICAgIC5lcShcImlkXCIsIHNlcnZpY2VJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHNlcnZpY2VFcnJvciB8fCAhc2VydmljZVJvdykge1xyXG4gICAgICB0aHJvdyBuZXcgQXBwb2ludG1lbnRDcmVhdGlvbkVycm9yKFwiU2VydmljaW8gaW52w6FsaWRvXCIsIDQwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFzZXJ2aWNlUm93LmFjdGl2ZSkge1xyXG4gICAgICB0aHJvdyBuZXcgQXBwb2ludG1lbnRDcmVhdGlvbkVycm9yKFwiRWwgc2VydmljaW8gZXN0w6EgcGF1c2Fkb1wiLCA0MDApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc29sdmVkU2VydmljZSA9IHNlcnZpY2VSb3cgYXMgU2VydmljZUxvb2t1cDtcclxuICB9XHJcblxyXG4gIGxldCByZXNvbHZlZFByb3ZpZGVyOiBQcm92aWRlckxvb2t1cCB8IG51bGwgPSBudWxsO1xyXG4gIGlmIChwcm92aWRlcklkKSB7XHJcbiAgICBjb25zdCB7IGRhdGE6IHByb3ZpZGVyUm93LCBlcnJvcjogcHJvdmlkZXJFcnJvciB9ID0gYXdhaXQgZGJcclxuICAgICAgLmZyb20oXCJhZ2VuZGFfcHJvdmlkZXJzXCIpXHJcbiAgICAgIC5zZWxlY3QoXCJpZCwgdGVuYW50X2lkLCBmdWxsX25hbWUsIGFjdGl2ZSwgZGVmYXVsdF9sb2NhdGlvbl9pZCwgbWV0YWRhdGFcIilcclxuICAgICAgLmVxKFwidGVuYW50X2lkXCIsIHRlbmFudElkKVxyXG4gICAgICAuZXEoXCJpZFwiLCBwcm92aWRlcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAocHJvdmlkZXJFcnJvciB8fCAhcHJvdmlkZXJSb3cpIHtcclxuICAgICAgdGhyb3cgbmV3IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcihcIlByb2Zlc2lvbmFsIGludsOhbGlkb1wiLCA0MDApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghcHJvdmlkZXJSb3cuYWN0aXZlKSB7XHJcbiAgICAgIHRocm93IG5ldyBBcHBvaW50bWVudENyZWF0aW9uRXJyb3IoXCJFbCBwcm9mZXNpb25hbCBlc3TDoSBwYXVzYWRvXCIsIDQwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzb2x2ZWRQcm92aWRlciA9IHByb3ZpZGVyUm93IGFzIFByb3ZpZGVyTG9va3VwO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZHVyYXRpb25Tb3VyY2UgPSBOdW1iZXIoZHVyYXRpb24gPz8gcmVzb2x2ZWRTZXJ2aWNlPy5kdXJhdGlvbl9taW51dGVzID8/IDMwKTtcclxuICBjb25zdCBkdXJhdGlvbk1pbnV0ZXMgPSBNYXRoLm1heCg1LCBOdW1iZXIuaXNGaW5pdGUoZHVyYXRpb25Tb3VyY2UpID8gZHVyYXRpb25Tb3VyY2UgOiAzMCk7XHJcbiAgY29uc3QgZW5kQXQgPSBhZGRNaW51dGVzKHN0YXJ0QXQsIGR1cmF0aW9uTWludXRlcyk7XHJcblxyXG4gIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdQYXRpZW50IH0gPSBhd2FpdCBkYlxyXG4gICAgLmZyb20oXCJhZ2VuZGFfcGF0aWVudHNcIilcclxuICAgIC5zZWxlY3QoXCJpZFwiKVxyXG4gICAgLmVxKFwidGVuYW50X2lkXCIsIHRlbmFudElkKVxyXG4gICAgLmVxKFwicGhvbmVfZTE2NFwiLCBub3JtYWxpemVkUGhvbmUpXHJcbiAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgbGV0IHBhdGllbnRJZCA9IChleGlzdGluZ1BhdGllbnQgYXMgUGljazxQYXRpZW50Um93LCBcImlkXCI+IHwgbnVsbCk/LmlkID8/IG51bGw7XHJcbiAgaWYgKCFwYXRpZW50SWQpIHtcclxuICAgIGNvbnN0IGluc2VydFBheWxvYWQgPSB7XHJcbiAgICAgIHRlbmFudF9pZDogdGVuYW50SWQsXHJcbiAgICAgIGZ1bGxfbmFtZTogcGF0aWVudCxcclxuICAgICAgcGhvbmVfZTE2NDogbm9ybWFsaXplZFBob25lLFxyXG4gICAgICBvcHRfb3V0OiBmYWxzZSxcclxuICAgIH0gc2F0aXNmaWVzIERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX3BhdGllbnRzXCJdW1wiSW5zZXJ0XCJdO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogaW5zZXJ0ZWQsIGVycm9yOiBwYXRpZW50RXJyb3IgfSA9IGF3YWl0IGRiXHJcbiAgICAgIC5mcm9tKFwiYWdlbmRhX3BhdGllbnRzXCIpXHJcbiAgICAgIC5pbnNlcnQoaW5zZXJ0UGF5bG9hZClcclxuICAgICAgLnNlbGVjdChcImlkXCIpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAocGF0aWVudEVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBBcHBvaW50bWVudENyZWF0aW9uRXJyb3IocGF0aWVudEVycm9yLm1lc3NhZ2UsIDQwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcGF0aWVudElkID0gKGluc2VydGVkIGFzIFBpY2s8UGF0aWVudFJvdywgXCJpZFwiPikuaWQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGF3YWl0IGRiLmZyb20oXCJhZ2VuZGFfcGF0aWVudHNcIikudXBkYXRlKHsgZnVsbF9uYW1lOiBwYXRpZW50IH0pLmVxKFwiaWRcIiwgcGF0aWVudElkKS5lcShcInRlbmFudF9pZFwiLCB0ZW5hbnRJZCk7XHJcbiAgfVxyXG5cclxuICBsZXQgbG9jYXRpb25JZDogc3RyaW5nIHwgbnVsbCA9IHJhd0xvY2F0aW9uSWQgPz8gcmVzb2x2ZWRQcm92aWRlcj8uZGVmYXVsdF9sb2NhdGlvbl9pZCA/PyBudWxsO1xyXG4gIGxldCBsb2NhdGlvbk5hbWUgPSBcIkNvbnN1bHRvcmlvXCI7XHJcbiAgbGV0IGxvY2F0aW9uVGltZXpvbmUgPSBcIkFtZXJpY2EvQXJnZW50aW5hL0J1ZW5vc19BaXJlc1wiO1xyXG4gIGxldCBidWZmZXJNaW51dGVzID0gMDtcclxuICBsZXQgYnVzaW5lc3NIb3VyczogUmVjb3JkPHN0cmluZywgW3N0cmluZywgc3RyaW5nXVtdPiA9IHt9O1xyXG5cclxuICBjb25zdCBhc3NpZ25Mb2NhdGlvbiA9IChyb3c6IExvY2F0aW9uTG9va3VwIHwgbnVsbCkgPT4ge1xyXG4gICAgaWYgKHJvdykge1xyXG4gICAgICBsb2NhdGlvbklkID0gcm93LmlkO1xyXG4gICAgICBsb2NhdGlvbk5hbWUgPSByb3cubmFtZTtcclxuICAgICAgbG9jYXRpb25UaW1lem9uZSA9IHJvdy50aW1lem9uZTtcclxuICAgICAgYnVmZmVyTWludXRlcyA9IHJvdy5idWZmZXJfbWludXRlcyA/PyAwO1xyXG4gICAgICBidXNpbmVzc0hvdXJzID0gKHJvdy5idXNpbmVzc19ob3VycyBhcyBSZWNvcmQ8c3RyaW5nLCBbc3RyaW5nLCBzdHJpbmddW10+KSA/PyB7fTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvY2F0aW9uSWQgPSBudWxsO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGlmIChsb2NhdGlvbklkKSB7XHJcbiAgICBjb25zdCB7IGRhdGE6IGxvY2F0aW9uUm93IH0gPSBhd2FpdCBkYlxyXG4gICAgICAuZnJvbShcImFnZW5kYV9sb2NhdGlvbnNcIilcclxuICAgICAgLnNlbGVjdChcImlkLCBuYW1lLCB0aW1lem9uZSwgYnVmZmVyX21pbnV0ZXMsIGJ1c2luZXNzX2hvdXJzXCIpXHJcbiAgICAgIC5lcShcInRlbmFudF9pZFwiLCB0ZW5hbnRJZClcclxuICAgICAgLmVxKFwiaWRcIiwgbG9jYXRpb25JZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgYXNzaWduTG9jYXRpb24oKGxvY2F0aW9uUm93IGFzIExvY2F0aW9uTG9va3VwIHwgbnVsbCkgPz8gbnVsbCk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWxvY2F0aW9uSWQpIHtcclxuICAgIGNvbnN0IHsgZGF0YTogZmFsbGJhY2sgfSA9IGF3YWl0IGRiXHJcbiAgICAgIC5mcm9tKFwiYWdlbmRhX2xvY2F0aW9uc1wiKVxyXG4gICAgICAuc2VsZWN0KFwiaWQsIG5hbWUsIHRpbWV6b25lLCBidWZmZXJfbWludXRlcywgYnVzaW5lc3NfaG91cnNcIilcclxuICAgICAgLmVxKFwidGVuYW50X2lkXCIsIHRlbmFudElkKVxyXG4gICAgICAub3JkZXIoXCJuYW1lXCIsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXHJcbiAgICAgIC5saW1pdCgxKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBhc3NpZ25Mb2NhdGlvbigoZmFsbGJhY2sgYXMgTG9jYXRpb25Mb29rdXAgfCBudWxsKSA/PyBudWxsKTtcclxuICB9XHJcblxyXG4gIGlmICghbG9jYXRpb25JZCkge1xyXG4gICAgdGhyb3cgbmV3IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcihcIkRlYmUgY3JlYXIgdW5hIHViaWNhY2nDs24gcHJpbWVyb1wiLCA0MDApO1xyXG4gIH1cclxuXHJcbiAgLy8gMS4gQ2hlY2sgUHJvdmlkZXIgT3ZlcnJpZGVcclxuICBpZiAocmVzb2x2ZWRQcm92aWRlcikge1xyXG4gICAgICBjb25zdCBwcm92U2NoZWR1bGUgPSAocmVzb2x2ZWRQcm92aWRlci5tZXRhZGF0YSBhcyBhbnkpPy5zY2hlZHVsZTtcclxuICAgICAgaWYgKHByb3ZTY2hlZHVsZSAmJiBPYmplY3Qua2V5cyhwcm92U2NoZWR1bGUpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGJ1c2luZXNzSG91cnMgPSBwcm92U2NoZWR1bGU7XHJcbiAgICAgIH1cclxuICB9XHJcblxyXG4gIC8vIDIuIEZhbGxiYWNrIGRlZmF1bHQgaG91cnMgaWYgZW1wdHkgKE1hdGNoZXMgZ2V0U2xvdHMgYmVoYXZpb3IpXHJcbiAgaWYgKE9iamVjdC5rZXlzKGJ1c2luZXNzSG91cnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgYnVzaW5lc3NIb3VycyA9IHtcclxuICAgICAgbW9uOiBbW1wiMDk6MDBcIiwgXCIxODowMFwiXV0sXHJcbiAgICAgIHR1ZTogW1tcIjA5OjAwXCIsIFwiMTg6MDBcIl1dLFxyXG4gICAgICB3ZWQ6IFtbXCIwOTowMFwiLCBcIjE4OjAwXCJdXSxcclxuICAgICAgdGh1OiBbW1wiMDk6MDBcIiwgXCIxODowMFwiXV0sXHJcbiAgICAgIGZyaTogW1tcIjA5OjAwXCIsIFwiMTg6MDBcIl1dLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHZhbGlkSG91cnMgPSBpc1dpdGhpbkJ1c2luZXNzSG91cnMoe1xyXG4gICAgc3RhcnQ6IHN0YXJ0QXQsXHJcbiAgICBlbmQ6IGVuZEF0LFxyXG4gICAgYnVzaW5lc3NIb3VycyxcclxuICAgIHRpbWVab25lOiBsb2NhdGlvblRpbWV6b25lLFxyXG4gIH0pO1xyXG5cclxuICBpZiAoIXZhbGlkSG91cnMpIHtcclxuICAgIGNvbnN0IGRlYnVnSW5mbyA9IGBTdGFydDogJHtzdGFydEF0LnRvSVNPU3RyaW5nKCl9LCBMb2NUWjogJHtsb2NhdGlvblRpbWV6b25lfSwgTG9jYWxEYXk6ICR7bmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoXCJlbi1VU1wiLCB7IHRpbWVab25lOiBsb2NhdGlvblRpbWV6b25lLCB3ZWVrZGF5OiBcInNob3J0XCIsIGhvdXI6ICdudW1lcmljJyB9KS5mb3JtYXQoc3RhcnRBdCl9YDtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtBcHBvaW50bWVudEVycm9yXSBPdXRzaWRlIEJ1c2luZXNzIEhvdXJzLiAke2RlYnVnSW5mb31gKTtcclxuICAgIHRocm93IG5ldyBBcHBvaW50bWVudENyZWF0aW9uRXJyb3IoYEZ1ZXJhIGRlbCBob3JhcmlvIGRlIGF0ZW5jacOzbiAoJHtkZWJ1Z0luZm99KWAsIDQwMCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjb25mbGljdFdpbmRvd1N0YXJ0ID0gYWRkTWludXRlcyhzdGFydEF0LCAtYnVmZmVyTWludXRlcyk7XHJcbiAgY29uc3QgY29uZmxpY3RXaW5kb3dFbmQgPSBhZGRNaW51dGVzKGVuZEF0LCBidWZmZXJNaW51dGVzKTtcclxuXHJcbiAgbGV0IGNvbmZsaWN0UXVlcnkgPSBkYlxyXG4gICAgLmZyb20oXCJhZ2VuZGFfYXBwb2ludG1lbnRzXCIpXHJcbiAgICAuc2VsZWN0KFwiaWRcIilcclxuICAgIC5lcShcInRlbmFudF9pZFwiLCB0ZW5hbnRJZClcclxuICAgIC5lcShcImxvY2F0aW9uX2lkXCIsIGxvY2F0aW9uSWQpXHJcbiAgICAubmVxKFwic3RhdHVzXCIsIFwiY2FuY2VsZWRcIilcclxuICAgIC5sdChcInN0YXJ0X2F0XCIsIGNvbmZsaWN0V2luZG93RW5kLnRvSVNPU3RyaW5nKCkpXHJcbiAgICAuZ3QoXCJlbmRfYXRcIiwgY29uZmxpY3RXaW5kb3dTdGFydC50b0lTT1N0cmluZygpKTtcclxuXHJcbiAgLypcclxuICAvLyBEaXNhYmxlZCB1bnRpbCBEQiBtaWdyYXRpb24gaXMgYXBwbGllZFxyXG4gIGlmIChyZXNvbHZlZFByb3ZpZGVyPy5pZCkge1xyXG4gICAgY29uZmxpY3RRdWVyeSA9IGNvbmZsaWN0UXVlcnkub3IoYHByb3ZpZGVyX2lkLmVxLiR7cmVzb2x2ZWRQcm92aWRlci5pZH0scHJvdmlkZXJfaWQuaXMubnVsbGApO1xyXG4gIH1cclxuICAqL1xyXG5cclxuICBjb25zdCB7IGRhdGE6IGNvbmZsaWN0cywgZXJyb3I6IGNvbmZsaWN0RXJyb3IgfSA9IGF3YWl0IGNvbmZsaWN0UXVlcnkubGltaXQoMSk7XHJcblxyXG4gIGlmIChjb25mbGljdEVycm9yKSB7XHJcbiAgICB0aHJvdyBuZXcgQXBwb2ludG1lbnRDcmVhdGlvbkVycm9yKGNvbmZsaWN0RXJyb3IubWVzc2FnZSwgNDAwKTtcclxuICB9XHJcblxyXG4gIGlmIChjb25mbGljdHMgJiYgY29uZmxpY3RzLmxlbmd0aCA+IDApIHtcclxuICAgIHRocm93IG5ldyBBcHBvaW50bWVudENyZWF0aW9uRXJyb3IoXCJZYSBoYXkgdW4gdHVybm8gZW4gZXNlIGhvcmFyaW9cIiwgNDA5KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHNlcnZpY2VTbmFwc2hvdCA9IHJlc29sdmVkU2VydmljZVxyXG4gICAgPyB7XHJcbiAgICAgICAgaWQ6IHJlc29sdmVkU2VydmljZS5pZCxcclxuICAgICAgICBuYW1lOiByZXNvbHZlZFNlcnZpY2UubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcmVzb2x2ZWRTZXJ2aWNlLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgIGR1cmF0aW9uX21pbnV0ZXM6IHJlc29sdmVkU2VydmljZS5kdXJhdGlvbl9taW51dGVzLFxyXG4gICAgICAgIHByaWNlX21pbm9yX3VuaXRzOiByZXNvbHZlZFNlcnZpY2UucHJpY2VfbWlub3JfdW5pdHMsXHJcbiAgICAgICAgY3VycmVuY3k6IHJlc29sdmVkU2VydmljZS5jdXJyZW5jeSxcclxuICAgICAgICBjb2xvcjogcmVzb2x2ZWRTZXJ2aWNlLmNvbG9yLFxyXG4gICAgICB9XHJcbiAgICA6IG51bGw7XHJcblxyXG4gIGNvbnN0IG5vcm1hbGl6ZWRTZXJ2aWNlTmFtZSA9IHJlc29sdmVkU2VydmljZT8ubmFtZSA/PyAoc2VydmljZU5hbWU/LnRyaW0oKS5sZW5ndGggPyBzZXJ2aWNlTmFtZT8udHJpbSgpIDogbnVsbCk7XHJcblxyXG4gIGNvbnN0IGFwcG9pbnRtZW50SW5zZXJ0ID0ge1xyXG4gICAgdGVuYW50X2lkOiB0ZW5hbnRJZCxcclxuICAgIGxvY2F0aW9uX2lkOiBsb2NhdGlvbklkLFxyXG4gICAgcGF0aWVudF9pZDogcGF0aWVudElkLFxyXG4gICAgc3RhcnRfYXQ6IHN0YXJ0QXQudG9JU09TdHJpbmcoKSxcclxuICAgIGVuZF9hdDogZW5kQXQudG9JU09TdHJpbmcoKSxcclxuICAgIHN0YXR1czogXCJwZW5kaW5nXCIsXHJcbiAgICAvLyBzZXJ2aWNlX2lkOiByZXNvbHZlZFNlcnZpY2U/LmlkID8/IG51bGwsIC8vIERJU0FCTEVEOiBEQiBzY2hlbWEgY2FjaGUgZXJyb3JcclxuICAgIC8vIHByb3ZpZGVyX2lkOiByZXNvbHZlZFByb3ZpZGVyPy5pZCA/PyBudWxsLCAvLyBESVNBQkxFRDogREIgY29sdW1uIG1pc3NpbmdcclxuICAgIHNlcnZpY2VfbmFtZTogbm9ybWFsaXplZFNlcnZpY2VOYW1lLFxyXG4gICAgLy8gc2VydmljZV9zbmFwc2hvdDogc2VydmljZVNuYXBzaG90LCAvLyBESVNBQkxFRDogREIgc2NoZW1hIGNhY2hlIGVycm9yXHJcbiAgICBpbnRlcm5hbF9ub3Rlczogbm90ZXMgPz8gbnVsbCxcclxuICB9IHNhdGlzZmllcyBBcHBvaW50bWVudEluc2VydDtcclxuXHJcbiAgY29uc3QgeyBlcnJvcjogYXBwdEVycm9yLCBkYXRhOiBhcHB0IH0gPSBhd2FpdCBkYlxyXG4gICAgLmZyb20oXCJhZ2VuZGFfYXBwb2ludG1lbnRzXCIpXHJcbiAgICAuaW5zZXJ0KGFwcG9pbnRtZW50SW5zZXJ0KVxyXG4gICAgLnNlbGVjdChcImlkLCBzdGFydF9hdCwgZW5kX2F0LCBzdGF0dXNcIilcclxuICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgaWYgKGFwcHRFcnJvcikge1xyXG4gICAgdGhyb3cgbmV3IEFwcG9pbnRtZW50Q3JlYXRpb25FcnJvcihhcHB0RXJyb3IubWVzc2FnZSwgNDAwKTtcclxuICB9XHJcblxyXG4gIGlmIChzZW5kTm90aWZpY2F0aW9ucykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgW2NyZWRlbnRpYWxzLCB0ZW1wbGF0ZU1hcF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgZ2V0V2hhdHNBcHBJbnRlZ3JhdGlvbkJ5VGVuYW50KGRiLCB0ZW5hbnRJZCksXHJcbiAgICAgICAgZ2V0VGVuYW50VGVtcGxhdGVNYXAoZGIsIHRlbmFudElkKSxcclxuICAgICAgXSk7XHJcblxyXG4gICAgICBpZiAoIWNyZWRlbnRpYWxzKSB7XHJcbiAgICAgICAgLy8gQ3JpdGljYWwgZXJyb3IgZm9yIGF1ZGl0aW5nXHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW0FwcG9pbnRtZW50Q3JlYXRpb25dIE1pc3NpbmcgV2hhdHNBcHAgY3JlZGVudGlhbHMgZm9yIHRlbmFudCAke3RlbmFudElkfS4gTWVzc2FnZSBOT1Qgc2VudC5gKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJXaGF0c0FwcCBpbnRlZ3JhdGlvbiBtaXNzaW5nIGZvciB0ZW5hbnRcIik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFRFTVBPUkFSWSBGQUxMQkFDSzogVXNlIGhlbGxvX3dvcmxkIGlmIGN1c3RvbSB0ZW1wbGF0ZSBpcyBub3QgcmVhZHkuXHJcbiAgICAgIGxldCB0ZW1wbGF0ZVRvU2VuZCA9IHRlbXBsYXRlT3ZlcnJpZGUgfHwgVEVNUExBVEVfTkFNRVMuYXBwb2ludG1lbnRDcmVhdGVkO1xyXG4gICAgICBsZXQgdmFyaWFibGVzVG9TZW5kOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCA9IFtcclxuICAgICAgICAgIHBhdGllbnQsXHJcbiAgICAgICAgICBzdGFydEF0LnRvTG9jYWxlRGF0ZVN0cmluZyhcImVzLUFSXCIpLFxyXG4gICAgICAgICAgc3RhcnRBdC50b0xvY2FsZVRpbWVTdHJpbmcoXCJlcy1BUlwiLCB7IGhvdXI6IFwiMi1kaWdpdFwiLCBtaW51dGU6IFwiMi1kaWdpdFwiIH0pLFxyXG4gICAgICAgICAgbG9jYXRpb25OYW1lLFxyXG4gICAgICAgICAgbG9jYXRpb25OYW1lIC8vIFVzaW5nIGxvY2F0aW9uIGFzIHRoZSA1dGggdmFyaWFibGUganVzdCBpbiBjYXNlXHJcbiAgICAgICAgXTtcclxuICAgICAgXHJcbiAgICAgIC8vIEZvcmNlIGhlbGxvX3dvcmxkIGp1c3QgZm9yIHRoaXMgdGVzdCB3aGlsZSBNZXRhIGFwcHJvdmVzIHRoZSByZWFsIG9uZVxyXG4gICAgICAvLyBVbmNvbW1lbnQgdGhlIG5leHQgbGluZSB0byB0ZXN0IE5PVyB3aXRoIHRoZSBnZW5lcmljIHRlbXBsYXRlXHJcbiAgICAgIHRlbXBsYXRlVG9TZW5kID0gXCJoZWxsb193b3JsZFwiOyB2YXJpYWJsZXNUb1NlbmQgPSB1bmRlZmluZWQ7IFxyXG5cclxuICAgICAgY29uc29sZS5sb2coYFtBcHBvaW50bWVudENyZWF0aW9uXSBTZW5kaW5nIFdoYXRzQXBwIHRvICR7bm9ybWFsaXplZFBob25lfSAoVGVtcGxhdGU6ICR7dGVtcGxhdGVUb1NlbmR9KWApO1xyXG5cclxuICAgICAgYXdhaXQgc2VuZFRlbXBsYXRlTWVzc2FnZSh7XHJcbiAgICAgICAgdG86IG5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgICB0ZW1wbGF0ZTogdGVtcGxhdGVUb1NlbmQsXHJcbiAgICAgICAgdmFyaWFibGVzOiB2YXJpYWJsZXNUb1NlbmQsXHJcbiAgICAgICAgbmFtZU92ZXJyaWRlOiBudWxsLCAvLyBGb3JjZSBubyBvdmVycmlkZSBmb3IgaGVsbG9fd29ybGRcclxuICAgICAgICBjcmVkZW50aWFscyxcclxuICAgICAgICBsYW5ndWFnZUNvZGU6IFwiZW5fVVNcIiAvLyBoZWxsb193b3JsZCB1c3VhbGx5IHJlcXVpcmVzIGVuX1VTXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgYXdhaXQgZGIuZnJvbShcImFnZW5kYV9tZXNzYWdlX2xvZ1wiKS5pbnNlcnQoe1xyXG4gICAgICAgIHRlbmFudF9pZDogdGVuYW50SWQsXHJcbiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkLFxyXG4gICAgICAgIGFwcG9pbnRtZW50X2lkOiAoYXBwdCBhcyBBcHBvaW50bWVudFJvdykuaWQsXHJcbiAgICAgICAgZGlyZWN0aW9uOiBcIm91dFwiLFxyXG4gICAgICAgIHR5cGU6IFRFTVBMQVRFX05BTUVTLmFwcG9pbnRtZW50Q3JlYXRlZCxcclxuICAgICAgICBzdGF0dXM6IFwic2VudFwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGxvZ0luZm8oXCJhcHBvaW50bWVudC5jcmVhdGVkX25vdGlmaWNhdGlvbl9zZW50XCIsIHtcclxuICAgICAgICB0ZW5hbnRfaWQ6IHRlbmFudElkLFxyXG4gICAgICAgIGFwcG9pbnRtZW50X2lkOiAoYXBwdCBhcyBBcHBvaW50bWVudFJvdykuaWQsXHJcbiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkLFxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBsb2dFcnJvcihcImFwcG9pbnRtZW50LmNyZWF0ZWRfbm90aWZpY2F0aW9uX2ZhaWxlZFwiLCB7XHJcbiAgICAgICAgdGVuYW50X2lkOiB0ZW5hbnRJZCxcclxuICAgICAgICBhcHBvaW50bWVudF9pZDogKGFwcHQgYXMgQXBwb2ludG1lbnRSb3cpLmlkLFxyXG4gICAgICAgIGVycm9yOiAoZXJyIGFzIEVycm9yKT8ubWVzc2FnZSA/PyBTdHJpbmcoZXJyKSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBhcHBvaW50bWVudDogYXBwdCB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJhZGRNaW51dGVzIiwiaXNXaXRoaW5CdXNpbmVzc0hvdXJzIiwic2VuZFRlbXBsYXRlTWVzc2FnZSIsIlRFTVBMQVRFX05BTUVTIiwiZ2V0VGVuYW50VGVtcGxhdGVNYXAiLCJnZXRXaGF0c0FwcEludGVncmF0aW9uQnlUZW5hbnQiLCJsb2dFcnJvciIsImxvZ0luZm8iLCJBcHBvaW50bWVudENyZWF0aW9uRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1cyIsImNyZWF0ZUFwcG9pbnRtZW50Rm9yVGVuYW50Iiwib3B0aW9ucyIsImRiIiwidGVuYW50SWQiLCJpbnB1dCIsInNlbmROb3RpZmljYXRpb25zIiwicGF0aWVudCIsInBob25lIiwic3RhcnQiLCJkdXJhdGlvbiIsInNlcnZpY2VOYW1lIiwibm90ZXMiLCJsb2NhdGlvbklkIiwicmF3TG9jYXRpb25JZCIsInNlcnZpY2VJZCIsInByb3ZpZGVySWQiLCJzdGFydEF0IiwiRGF0ZSIsIk51bWJlciIsImlzRmluaXRlIiwiZ2V0VGltZSIsImNsZWFuZWRQaG9uZSIsInRyaW0iLCJyZXBsYWNlIiwibm9ybWFsaXplZFBob25lIiwic3RhcnRzV2l0aCIsInJlc29sdmVkU2VydmljZSIsImRhdGEiLCJzZXJ2aWNlUm93IiwiZXJyb3IiLCJzZXJ2aWNlRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJtYXliZVNpbmdsZSIsImFjdGl2ZSIsInJlc29sdmVkUHJvdmlkZXIiLCJwcm92aWRlclJvdyIsInByb3ZpZGVyRXJyb3IiLCJkdXJhdGlvblNvdXJjZSIsImR1cmF0aW9uX21pbnV0ZXMiLCJkdXJhdGlvbk1pbnV0ZXMiLCJNYXRoIiwibWF4IiwiZW5kQXQiLCJleGlzdGluZ1BhdGllbnQiLCJwYXRpZW50SWQiLCJpZCIsImluc2VydFBheWxvYWQiLCJ0ZW5hbnRfaWQiLCJmdWxsX25hbWUiLCJwaG9uZV9lMTY0Iiwib3B0X291dCIsImluc2VydGVkIiwicGF0aWVudEVycm9yIiwiaW5zZXJ0Iiwic2luZ2xlIiwidXBkYXRlIiwiZGVmYXVsdF9sb2NhdGlvbl9pZCIsImxvY2F0aW9uTmFtZSIsImxvY2F0aW9uVGltZXpvbmUiLCJidWZmZXJNaW51dGVzIiwiYnVzaW5lc3NIb3VycyIsImFzc2lnbkxvY2F0aW9uIiwicm93IiwibmFtZSIsInRpbWV6b25lIiwiYnVmZmVyX21pbnV0ZXMiLCJidXNpbmVzc19ob3VycyIsImxvY2F0aW9uUm93IiwiZmFsbGJhY2siLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0IiwicHJvdlNjaGVkdWxlIiwibWV0YWRhdGEiLCJzY2hlZHVsZSIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJtb24iLCJ0dWUiLCJ3ZWQiLCJ0aHUiLCJmcmkiLCJ2YWxpZEhvdXJzIiwiZW5kIiwidGltZVpvbmUiLCJkZWJ1Z0luZm8iLCJ0b0lTT1N0cmluZyIsIkludGwiLCJEYXRlVGltZUZvcm1hdCIsIndlZWtkYXkiLCJob3VyIiwiZm9ybWF0IiwiY29uc29sZSIsImNvbmZsaWN0V2luZG93U3RhcnQiLCJjb25mbGljdFdpbmRvd0VuZCIsImNvbmZsaWN0UXVlcnkiLCJuZXEiLCJsdCIsImd0IiwiY29uZmxpY3RzIiwiY29uZmxpY3RFcnJvciIsInNlcnZpY2VTbmFwc2hvdCIsImRlc2NyaXB0aW9uIiwicHJpY2VfbWlub3JfdW5pdHMiLCJjdXJyZW5jeSIsImNvbG9yIiwibm9ybWFsaXplZFNlcnZpY2VOYW1lIiwiYXBwb2ludG1lbnRJbnNlcnQiLCJsb2NhdGlvbl9pZCIsInBhdGllbnRfaWQiLCJzdGFydF9hdCIsImVuZF9hdCIsInNlcnZpY2VfbmFtZSIsImludGVybmFsX25vdGVzIiwiYXBwdEVycm9yIiwiYXBwdCIsImNyZWRlbnRpYWxzIiwidGVtcGxhdGVNYXAiLCJQcm9taXNlIiwiYWxsIiwidGVtcGxhdGVUb1NlbmQiLCJ0ZW1wbGF0ZU92ZXJyaWRlIiwiYXBwb2ludG1lbnRDcmVhdGVkIiwidmFyaWFibGVzVG9TZW5kIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwibWludXRlIiwidW5kZWZpbmVkIiwibG9nIiwidG8iLCJ0ZW1wbGF0ZSIsInZhcmlhYmxlcyIsIm5hbWVPdmVycmlkZSIsImxhbmd1YWdlQ29kZSIsImFwcG9pbnRtZW50X2lkIiwiZGlyZWN0aW9uIiwidHlwZSIsImVyciIsIlN0cmluZyIsImFwcG9pbnRtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/server/appointments/createAppointment.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/tenant-headers.ts":
/*!**************************************!*\
  !*** ./src/server/tenant-headers.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTenantHeaderInfo: () => (/* binding */ getTenantHeaderInfo)\n/* harmony export */ });\nconst DEV_TENANT_SLUG = process.env.NEXT_PUBLIC_DEV_TENANT_SLUG ?? \"tenant_1\";\nfunction getTenantHeaderInfo(headerBag) {\n    const slug = headerBag.get(\"x-tenant-id\");\n    const internalId = headerBag.get(\"x-tenant-internal-id\");\n    const isDevBypass =  true && slug === DEV_TENANT_SLUG;\n    return {\n        slug,\n        internalId,\n        isDevBypass\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3RlbmFudC1oZWFkZXJzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxNQUFNQSxrQkFBa0JDLFFBQVFDLEdBQUcsQ0FBQ0MsMkJBQTJCLElBQUk7QUFFNUQsU0FBU0Msb0JBQW9CQyxTQUFrQjtJQUNwRCxNQUFNQyxPQUFPRCxVQUFVRSxHQUFHLENBQUM7SUFDM0IsTUFBTUMsYUFBYUgsVUFBVUUsR0FBRyxDQUFDO0lBQ2pDLE1BQU1FLGNBQWNSLEtBQXNDLElBQUlLLFNBQVNOO0lBQ3ZFLE9BQU87UUFBRU07UUFBTUU7UUFBWUM7SUFBWTtBQUN6QyIsInNvdXJjZXMiOlsid2VicGFjazovL2FnZW5kYXItYXBwLy4vc3JjL3NlcnZlci90ZW5hbnQtaGVhZGVycy50cz9mYjk5Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IERFVl9URU5BTlRfU0xVRyA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0RFVl9URU5BTlRfU0xVRyA/PyBcInRlbmFudF8xXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVuYW50SGVhZGVySW5mbyhoZWFkZXJCYWc6IEhlYWRlcnMpIHtcclxuICBjb25zdCBzbHVnID0gaGVhZGVyQmFnLmdldChcIngtdGVuYW50LWlkXCIpO1xyXG4gIGNvbnN0IGludGVybmFsSWQgPSBoZWFkZXJCYWcuZ2V0KFwieC10ZW5hbnQtaW50ZXJuYWwtaWRcIik7XHJcbiAgY29uc3QgaXNEZXZCeXBhc3MgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiICYmIHNsdWcgPT09IERFVl9URU5BTlRfU0xVRztcclxuICByZXR1cm4geyBzbHVnLCBpbnRlcm5hbElkLCBpc0RldkJ5cGFzcyB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJERVZfVEVOQU5UX1NMVUciLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfREVWX1RFTkFOVF9TTFVHIiwiZ2V0VGVuYW50SGVhZGVySW5mbyIsImhlYWRlckJhZyIsInNsdWciLCJnZXQiLCJpbnRlcm5hbElkIiwiaXNEZXZCeXBhc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/server/tenant-headers.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/whatsapp-config.ts":
/*!***************************************!*\
  !*** ./src/server/whatsapp-config.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTenantTemplateMap: () => (/* binding */ getTenantTemplateMap),\n/* harmony export */   getWhatsAppIntegrationByPhoneId: () => (/* binding */ getWhatsAppIntegrationByPhoneId),\n/* harmony export */   getWhatsAppIntegrationByTenant: () => (/* binding */ getWhatsAppIntegrationByTenant),\n/* harmony export */   getWhatsAppIntegrationByVerifyToken: () => (/* binding */ getWhatsAppIntegrationByVerifyToken)\n/* harmony export */ });\nconst PROVIDER = \"meta_whatsapp\";\nfunction parseCredentials(credentials) {\n    if (!credentials || typeof credentials !== \"object\") return null;\n    const maybeCreds = credentials;\n    const phoneNumberId = typeof maybeCreds.phoneNumberId === \"string\" ? maybeCreds.phoneNumberId : undefined;\n    const accessToken = typeof maybeCreds.accessToken === \"string\" ? maybeCreds.accessToken : undefined;\n    const businessAccountId = typeof maybeCreds.businessAccountId === \"string\" ? maybeCreds.businessAccountId : null;\n    const verifyToken = typeof maybeCreds.verifyToken === \"string\" ? maybeCreds.verifyToken : null;\n    if (!phoneNumberId || !accessToken) {\n        return null;\n    }\n    return {\n        phoneNumberId,\n        accessToken,\n        businessAccountId,\n        verifyToken\n    };\n}\nasync function fetchIntegration(db, filters) {\n    let query = db.from(\"agenda_integrations\").select(\"id, tenant_id, provider, credentials, created_at, updated_at\").eq(\"provider\", PROVIDER).limit(1);\n    for (const [path, value] of Object.entries(filters)){\n        query = query.filter(path, \"eq\", value);\n    }\n    const { data, error } = await query.maybeSingle();\n    if (error || !data) return null;\n    const parsed = parseCredentials(data.credentials);\n    if (!parsed) return null;\n    return {\n        ...data,\n        credentials_parsed: parsed\n    };\n}\nasync function getWhatsAppIntegrationByTenant(db, tenantId) {\n    const record = await db.from(\"agenda_integrations\").select(\"tenant_id, provider, credentials, created_at, updated_at\").eq(\"tenant_id\", tenantId).eq(\"provider\", PROVIDER).maybeSingle();\n    if (record.error || !record.data) return null;\n    return parseCredentials(record.data.credentials);\n}\nasync function getWhatsAppIntegrationByPhoneId(db, phoneNumberId) {\n    const record = await fetchIntegration(db, {\n        \"credentials->>phoneNumberId\": phoneNumberId\n    });\n    if (!record) return null;\n    return {\n        tenantId: record.tenant_id,\n        credentials: record.credentials_parsed\n    };\n}\nasync function getWhatsAppIntegrationByVerifyToken(db, verifyToken) {\n    const record = await fetchIntegration(db, {\n        \"credentials->>verifyToken\": verifyToken\n    });\n    if (!record) return null;\n    return {\n        tenantId: record.tenant_id,\n        credentials: record.credentials_parsed\n    };\n}\nasync function getTenantTemplateMap(db, tenantId) {\n    const map = new Map();\n    const { data } = await db.from(\"agenda_message_templates\").select(\"name, meta_template_name, status\").eq(\"tenant_id\", tenantId);\n    for (const row of data ?? []){\n        map.set(row.name, {\n            metaTemplateName: row.meta_template_name,\n            status: row.status\n        });\n    }\n    return map;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1RLE9BQVFkLFFBQVEsRUFBRSxDQUF5RTtRQUNwR1ksSUFBSUcsR0FBRyxDQUFDRCxJQUFJRSxJQUFJLEVBQUU7WUFDaEJDLGtCQUFrQkgsSUFBSUksa0JBQWtCO1lBQ3hDQyxRQUFRTCxJQUFJSyxNQUFNO1FBQ3BCO0lBQ0Y7SUFFQSxPQUFPUDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbmRhci1hcHAvLi9zcmMvc2VydmVyL3doYXRzYXBwLWNvbmZpZy50cz8wMmQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1cGFiYXNlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xyXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gXCJAL3R5cGVzL2RhdGFiYXNlXCI7XHJcblxyXG5jb25zdCBQUk9WSURFUiA9IFwibWV0YV93aGF0c2FwcFwiO1xyXG5cclxudHlwZSBJbnRlZ3JhdGlvblJvdyA9IERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX2ludGVncmF0aW9uc1wiXVtcIlJvd1wiXTtcclxudHlwZSBUZW1wbGF0ZVJvdyA9IERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX21lc3NhZ2VfdGVtcGxhdGVzXCJdW1wiUm93XCJdO1xyXG5cclxuZXhwb3J0IHR5cGUgV2hhdHNBcHBDcmVkZW50aWFscyA9IHtcclxuICBwaG9uZU51bWJlcklkOiBzdHJpbmc7XHJcbiAgYWNjZXNzVG9rZW46IHN0cmluZztcclxuICBidXNpbmVzc0FjY291bnRJZD86IHN0cmluZyB8IG51bGw7XHJcbiAgdmVyaWZ5VG9rZW4/OiBzdHJpbmcgfCBudWxsO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcGFyc2VDcmVkZW50aWFscyhjcmVkZW50aWFsczogSW50ZWdyYXRpb25Sb3dbXCJjcmVkZW50aWFsc1wiXSk6IFdoYXRzQXBwQ3JlZGVudGlhbHMgfCBudWxsIHtcclxuICBpZiAoIWNyZWRlbnRpYWxzIHx8IHR5cGVvZiBjcmVkZW50aWFscyAhPT0gXCJvYmplY3RcIikgcmV0dXJuIG51bGw7XHJcblxyXG4gIGNvbnN0IG1heWJlQ3JlZHMgPSBjcmVkZW50aWFscyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuICBjb25zdCBwaG9uZU51bWJlcklkID0gdHlwZW9mIG1heWJlQ3JlZHMucGhvbmVOdW1iZXJJZCA9PT0gXCJzdHJpbmdcIiA/IG1heWJlQ3JlZHMucGhvbmVOdW1iZXJJZCA6IHVuZGVmaW5lZDtcclxuICBjb25zdCBhY2Nlc3NUb2tlbiA9IHR5cGVvZiBtYXliZUNyZWRzLmFjY2Vzc1Rva2VuID09PSBcInN0cmluZ1wiID8gbWF5YmVDcmVkcy5hY2Nlc3NUb2tlbiA6IHVuZGVmaW5lZDtcclxuICBjb25zdCBidXNpbmVzc0FjY291bnRJZCA9IHR5cGVvZiBtYXliZUNyZWRzLmJ1c2luZXNzQWNjb3VudElkID09PSBcInN0cmluZ1wiID8gbWF5YmVDcmVkcy5idXNpbmVzc0FjY291bnRJZCA6IG51bGw7XHJcbiAgY29uc3QgdmVyaWZ5VG9rZW4gPSB0eXBlb2YgbWF5YmVDcmVkcy52ZXJpZnlUb2tlbiA9PT0gXCJzdHJpbmdcIiA/IG1heWJlQ3JlZHMudmVyaWZ5VG9rZW4gOiBudWxsO1xyXG5cclxuICBpZiAoIXBob25lTnVtYmVySWQgfHwgIWFjY2Vzc1Rva2VuKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBwaG9uZU51bWJlcklkLFxyXG4gICAgYWNjZXNzVG9rZW4sXHJcbiAgICBidXNpbmVzc0FjY291bnRJZCxcclxuICAgIHZlcmlmeVRva2VuLFxyXG4gIH07XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGZldGNoSW50ZWdyYXRpb24oXHJcbiAgZGI6IFN1cGFiYXNlQ2xpZW50PERhdGFiYXNlPixcclxuICBmaWx0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxyXG4pOiBQcm9taXNlPChJbnRlZ3JhdGlvblJvdyAmIHsgY3JlZGVudGlhbHNfcGFyc2VkOiBXaGF0c0FwcENyZWRlbnRpYWxzIH0pIHwgbnVsbD4ge1xyXG4gIGxldCBxdWVyeSA9IGRiXHJcbiAgICAuZnJvbShcImFnZW5kYV9pbnRlZ3JhdGlvbnNcIilcclxuICAgIC5zZWxlY3QoXCJpZCwgdGVuYW50X2lkLCBwcm92aWRlciwgY3JlZGVudGlhbHMsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXRcIilcclxuICAgIC5lcShcInByb3ZpZGVyXCIsIFBST1ZJREVSKVxyXG4gICAgLmxpbWl0KDEpO1xyXG5cclxuICBmb3IgKGNvbnN0IFtwYXRoLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZmlsdGVycykpIHtcclxuICAgIHF1ZXJ5ID0gcXVlcnkuZmlsdGVyKHBhdGgsIFwiZXFcIiwgdmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnkubWF5YmVTaW5nbGUoKTtcclxuICBpZiAoZXJyb3IgfHwgIWRhdGEpIHJldHVybiBudWxsO1xyXG5cclxuICBjb25zdCBwYXJzZWQgPSBwYXJzZUNyZWRlbnRpYWxzKGRhdGEuY3JlZGVudGlhbHMpO1xyXG4gIGlmICghcGFyc2VkKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgcmV0dXJuIHsgLi4uZGF0YSwgY3JlZGVudGlhbHNfcGFyc2VkOiBwYXJzZWQgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdoYXRzQXBwSW50ZWdyYXRpb25CeVRlbmFudChcclxuICBkYjogU3VwYWJhc2VDbGllbnQ8RGF0YWJhc2U+LFxyXG4gIHRlbmFudElkOiBzdHJpbmcsXHJcbik6IFByb21pc2U8V2hhdHNBcHBDcmVkZW50aWFscyB8IG51bGw+IHtcclxuICBjb25zdCByZWNvcmQgPSBhd2FpdCBkYlxyXG4gICAgLmZyb20oXCJhZ2VuZGFfaW50ZWdyYXRpb25zXCIpXHJcbiAgICAuc2VsZWN0KFwidGVuYW50X2lkLCBwcm92aWRlciwgY3JlZGVudGlhbHMsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXRcIilcclxuICAgIC5lcShcInRlbmFudF9pZFwiLCB0ZW5hbnRJZClcclxuICAgIC5lcShcInByb3ZpZGVyXCIsIFBST1ZJREVSKVxyXG4gICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gIGlmIChyZWNvcmQuZXJyb3IgfHwgIXJlY29yZC5kYXRhKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4gcGFyc2VDcmVkZW50aWFscyhyZWNvcmQuZGF0YS5jcmVkZW50aWFscyk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRXaGF0c0FwcEludGVncmF0aW9uQnlQaG9uZUlkKFxyXG4gIGRiOiBTdXBhYmFzZUNsaWVudDxEYXRhYmFzZT4sXHJcbiAgcGhvbmVOdW1iZXJJZDogc3RyaW5nLFxyXG4pOiBQcm9taXNlPHsgdGVuYW50SWQ6IHN0cmluZzsgY3JlZGVudGlhbHM6IFdoYXRzQXBwQ3JlZGVudGlhbHMgfSB8IG51bGw+IHtcclxuICBjb25zdCByZWNvcmQgPSBhd2FpdCBmZXRjaEludGVncmF0aW9uKGRiLCB7IFwiY3JlZGVudGlhbHMtPj5waG9uZU51bWJlcklkXCI6IHBob25lTnVtYmVySWQgfSk7XHJcbiAgaWYgKCFyZWNvcmQpIHJldHVybiBudWxsO1xyXG4gIHJldHVybiB7IHRlbmFudElkOiByZWNvcmQudGVuYW50X2lkLCBjcmVkZW50aWFsczogcmVjb3JkLmNyZWRlbnRpYWxzX3BhcnNlZCB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0V2hhdHNBcHBJbnRlZ3JhdGlvbkJ5VmVyaWZ5VG9rZW4oXHJcbiAgZGI6IFN1cGFiYXNlQ2xpZW50PERhdGFiYXNlPixcclxuICB2ZXJpZnlUb2tlbjogc3RyaW5nLFxyXG4pOiBQcm9taXNlPHsgdGVuYW50SWQ6IHN0cmluZzsgY3JlZGVudGlhbHM6IFdoYXRzQXBwQ3JlZGVudGlhbHMgfSB8IG51bGw+IHtcclxuICBjb25zdCByZWNvcmQgPSBhd2FpdCBmZXRjaEludGVncmF0aW9uKGRiLCB7IFwiY3JlZGVudGlhbHMtPj52ZXJpZnlUb2tlblwiOiB2ZXJpZnlUb2tlbiB9KTtcclxuICBpZiAoIXJlY29yZCkgcmV0dXJuIG51bGw7XHJcbiAgcmV0dXJuIHsgdGVuYW50SWQ6IHJlY29yZC50ZW5hbnRfaWQsIGNyZWRlbnRpYWxzOiByZWNvcmQuY3JlZGVudGlhbHNfcGFyc2VkIH07XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFRlbmFudFRlbXBsYXRlQ29uZmlnID0ge1xyXG4gIG1ldGFUZW1wbGF0ZU5hbWU/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHN0YXR1cz86IHN0cmluZyB8IG51bGw7XHJcbn07XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGVuYW50VGVtcGxhdGVNYXAoXHJcbiAgZGI6IFN1cGFiYXNlQ2xpZW50PERhdGFiYXNlPixcclxuICB0ZW5hbnRJZDogc3RyaW5nLFxyXG4pOiBQcm9taXNlPE1hcDxzdHJpbmcsIFRlbmFudFRlbXBsYXRlQ29uZmlnPj4ge1xyXG4gIGNvbnN0IG1hcCA9IG5ldyBNYXA8c3RyaW5nLCBUZW5hbnRUZW1wbGF0ZUNvbmZpZz4oKTtcclxuICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGRiXHJcbiAgICAuZnJvbShcImFnZW5kYV9tZXNzYWdlX3RlbXBsYXRlc1wiKVxyXG4gICAgLnNlbGVjdChcIm5hbWUsIG1ldGFfdGVtcGxhdGVfbmFtZSwgc3RhdHVzXCIpXHJcbiAgICAuZXEoXCJ0ZW5hbnRfaWRcIiwgdGVuYW50SWQpO1xyXG5cclxuICBmb3IgKGNvbnN0IHJvdyBvZiAoZGF0YSA/PyBbXSkgYXMgQXJyYXk8UGljazxUZW1wbGF0ZVJvdywgXCJuYW1lXCIgfCBcIm1ldGFfdGVtcGxhdGVfbmFtZVwiIHwgXCJzdGF0dXNcIj4+KSB7XHJcbiAgICBtYXAuc2V0KHJvdy5uYW1lLCB7XHJcbiAgICAgIG1ldGFUZW1wbGF0ZU5hbWU6IHJvdy5tZXRhX3RlbXBsYXRlX25hbWUsXHJcbiAgICAgIHN0YXR1czogcm93LnN0YXR1cyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG1hcDtcclxufVxyXG4iXSwibmFtZXMiOlsiUFJPVklERVIiLCJwYXJzZUNyZWRlbnRpYWxzIiwiY3JlZGVudGlhbHMiLCJtYXliZUNyZWRzIiwicGhvbmVOdW1iZXJJZCIsInVuZGVmaW5lZCIsImFjY2Vzc1Rva2VuIiwiYnVzaW5lc3NBY2NvdW50SWQiLCJ2ZXJpZnlUb2tlbiIsImZldGNoSW50ZWdyYXRpb24iLCJkYiIsImZpbHRlcnMiLCJxdWVyeSIsImZyb20iLCJzZWxlY3QiLCJlcSIsImxpbWl0IiwicGF0aCIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImZpbHRlciIsImRhdGEiLCJlcnJvciIsIm1heWJlU2luZ2xlIiwicGFyc2VkIiwiY3JlZGVudGlhbHNfcGFyc2VkIiwiZ2V0V2hhdHNBcHBJbnRlZ3JhdGlvbkJ5VGVuYW50IiwidGVuYW50SWQiLCJyZWNvcmQiLCJnZXRXaGF0c0FwcEludGVncmF0aW9uQnlQaG9uZUlkIiwidGVuYW50X2lkIiwiZ2V0V2hhdHNBcHBJbnRlZ3JhdGlvbkJ5VmVyaWZ5VG9rZW4iLCJnZXRUZW5hbnRUZW1wbGF0ZU1hcCIsIm1hcCIsIk1hcCIsInJvdyIsInNldCIsIm5hbWUiLCJtZXRhVGVtcGxhdGVOYW1lIiwibWV0YV90ZW1wbGF0ZV9uYW1lIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/server/whatsapp-config.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/set-cookie-parser","vendor-chunks/jose","vendor-chunks/date-fns","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fappointments%2Froute&page=%2Fapi%2Fappointments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fappointments%2Froute.ts&appDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Crementeriama%5CDownloads%5CCode%5CAgend.ar&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();