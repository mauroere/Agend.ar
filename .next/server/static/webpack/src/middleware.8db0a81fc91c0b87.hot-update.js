"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/lib/supabase/service.ts":
/*!*************************************!*\
  !*** ./src/lib/supabase/service.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   serviceClient: () => (/* binding */ serviceClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(middleware)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\nconst url = \"https://oaxielrsiogvnxradtsw.supabase.co\";\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!url || !serviceKey) {\n    console.warn(\"Supabase service client is not fully configured.\");\n}\nconst serviceClient = url && serviceKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, serviceKey, {\n    auth: {\n        persistSession: false\n    }\n}) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL2xpYi9zdXBhYmFzZS9zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXFEO0FBR3JELE1BQU1DLE1BQU1DLDBDQUFvQztBQUNoRCxNQUFNRyxhQUFhSCxRQUFRQyxHQUFHLENBQUNHLHlCQUF5QjtBQUV4RCxJQUFJLENBQUNMLE9BQU8sQ0FBQ0ksWUFBWTtJQUN2QkUsUUFBUUMsSUFBSSxDQUFDO0FBQ2Y7QUFFTyxNQUFNQyxnQkFBZ0JSLE9BQU9JLGFBQ2hDTCxtRUFBWUEsQ0FBV0MsS0FBS0ksWUFBWTtJQUN0Q0ssTUFBTTtRQUFFQyxnQkFBZ0I7SUFBTTtBQUNoQyxLQUNBLEtBQUsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2xpYi9zdXBhYmFzZS9zZXJ2aWNlLnRzP2MyMGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xyXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gXCJAL3R5cGVzL2RhdGFiYXNlXCI7XHJcblxyXG5jb25zdCB1cmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkw7XHJcbmNvbnN0IHNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuaWYgKCF1cmwgfHwgIXNlcnZpY2VLZXkpIHtcclxuICBjb25zb2xlLndhcm4oXCJTdXBhYmFzZSBzZXJ2aWNlIGNsaWVudCBpcyBub3QgZnVsbHkgY29uZmlndXJlZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBzZXJ2aWNlQ2xpZW50ID0gdXJsICYmIHNlcnZpY2VLZXlcclxuICA/IGNyZWF0ZUNsaWVudDxEYXRhYmFzZT4odXJsLCBzZXJ2aWNlS2V5LCB7XHJcbiAgICAgIGF1dGg6IHsgcGVyc2lzdFNlc3Npb246IGZhbHNlIH0sXHJcbiAgICB9KVxyXG4gIDogbnVsbDtcclxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwic2VydmljZUNsaWVudCIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/lib/supabase/service.ts\n");

/***/ }),

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(middleware)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _server_tenant_routing__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/server/tenant-routing */ \"(middleware)/./src/server/tenant-routing.ts\");\n\n\n\nconst PUBLIC_PATH_PREFIXES = [\n    \"/login\",\n    \"/register\",\n    \"/api/auth/register\",\n    \"/api/webhooks/whatsapp\",\n    \"/api/repair\",\n    \"/book\",\n    \"/api/public\"\n];\nconst DEV_TENANT_SLUG = process.env.NEXT_PUBLIC_DEV_TENANT_SLUG ?? \"tenant_1\";\nconst DEV_TENANT_ID = process.env.NEXT_PUBLIC_DEV_TENANT_ID ?? null;\nlet cachedDevTenant = null;\nfunction isPublicPath(pathname) {\n    return PUBLIC_PATH_PREFIXES.some((prefix)=>pathname === prefix || pathname.startsWith(`${prefix}/`));\n}\nasync function resolveDevTenant() {\n    if (cachedDevTenant) return cachedDevTenant;\n    if (DEV_TENANT_ID) {\n        cachedDevTenant = {\n            slug: DEV_TENANT_SLUG,\n            id: DEV_TENANT_ID\n        };\n        return cachedDevTenant;\n    }\n    const tenant = await (0,_server_tenant_routing__WEBPACK_IMPORTED_MODULE_2__.findTenantByPublicIdentifier)({\n        slug: DEV_TENANT_SLUG\n    });\n    cachedDevTenant = {\n        slug: DEV_TENANT_SLUG,\n        id: tenant?.id ?? null\n    };\n    return cachedDevTenant;\n}\nasync function resolveTenantFromHost(host) {\n    if (!host) {\n        return resolveDevTenant();\n    }\n    const normalizedHost = host.toLowerCase().split(\":\")[0];\n    if (normalizedHost.startsWith(\"localhost\") || normalizedHost.startsWith(\"127.\") || normalizedHost === \"[::1]\") {\n        return resolveDevTenant();\n    }\n    const segments = normalizedHost.split(\".\");\n    const slugCandidate = segments.length >= 3 && segments[0] !== \"www\" ? segments[0] : null;\n    const tenant = await (0,_server_tenant_routing__WEBPACK_IMPORTED_MODULE_2__.findTenantByPublicIdentifier)({\n        domain: normalizedHost,\n        slug: slugCandidate\n    });\n    if (!tenant) {\n        return null;\n    }\n    return {\n        slug: tenant.public_slug ?? slugCandidate ?? null,\n        id: tenant.id\n    };\n}\nasync function middleware(req) {\n    const res = next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next();\n    const supabase = (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__.createMiddlewareClient)({\n        req,\n        res\n    });\n    const { data: { session } } = await supabase.auth.getSession();\n    const { pathname, host } = req.nextUrl;\n    const isPublic = isPublicPath(pathname);\n    if (!isPublic && !session) {\n        const url = req.nextUrl.clone();\n        url.pathname = \"/login\";\n        url.searchParams.set(\"redirect\", pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(url);\n    }\n    const tenantResolution = await resolveTenantFromHost(host);\n    if (tenantResolution?.slug) {\n        res.headers.set(\"x-tenant-id\", tenantResolution.slug);\n    }\n    if (tenantResolution?.id) {\n        res.headers.set(\"x-tenant-internal-id\", tenantResolution.id);\n    }\n    return res;\n}\nconst config = {\n    matcher: [\n        \"/((?!_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRTtJQUM3RDtJQUVBLE9BQU9jO0FBQ1Q7QUFFTyxNQUFNZ0IsU0FBUztJQUNwQkMsU0FBUztRQUFDO0tBQWdEO0FBQzVELEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9hdXRoLWhlbHBlcnMtbmV4dGpzXCI7XHJcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IGZpbmRUZW5hbnRCeVB1YmxpY0lkZW50aWZpZXIgfSBmcm9tIFwiQC9zZXJ2ZXIvdGVuYW50LXJvdXRpbmdcIjtcclxuXHJcbmNvbnN0IFBVQkxJQ19QQVRIX1BSRUZJWEVTID0gW1xyXG4gIFwiL2xvZ2luXCIsXHJcbiAgXCIvcmVnaXN0ZXJcIixcclxuICBcIi9hcGkvYXV0aC9yZWdpc3RlclwiLFxyXG4gIFwiL2FwaS93ZWJob29rcy93aGF0c2FwcFwiLFxyXG4gIFwiL2FwaS9yZXBhaXJcIixcclxuICBcIi9ib29rXCIsXHJcbiAgXCIvYXBpL3B1YmxpY1wiLFxyXG5dO1xyXG5cclxuY29uc3QgREVWX1RFTkFOVF9TTFVHID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfREVWX1RFTkFOVF9TTFVHID8/IFwidGVuYW50XzFcIjtcclxuY29uc3QgREVWX1RFTkFOVF9JRCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0RFVl9URU5BTlRfSUQgPz8gbnVsbDtcclxuXHJcbnR5cGUgVGVuYW50UmVzb2x1dGlvbiA9IHtcclxuICBzbHVnOiBzdHJpbmcgfCBudWxsO1xyXG4gIGlkOiBzdHJpbmcgfCBudWxsO1xyXG59O1xyXG5cclxubGV0IGNhY2hlZERldlRlbmFudDogVGVuYW50UmVzb2x1dGlvbiB8IG51bGwgPSBudWxsO1xyXG5cclxuZnVuY3Rpb24gaXNQdWJsaWNQYXRoKHBhdGhuYW1lOiBzdHJpbmcpIHtcclxuICByZXR1cm4gUFVCTElDX1BBVEhfUFJFRklYRVMuc29tZSgocHJlZml4KSA9PiBwYXRobmFtZSA9PT0gcHJlZml4IHx8IHBhdGhuYW1lLnN0YXJ0c1dpdGgoYCR7cHJlZml4fS9gKSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHJlc29sdmVEZXZUZW5hbnQoKTogUHJvbWlzZTxUZW5hbnRSZXNvbHV0aW9uPiB7XHJcbiAgaWYgKGNhY2hlZERldlRlbmFudCkgcmV0dXJuIGNhY2hlZERldlRlbmFudDtcclxuICBpZiAoREVWX1RFTkFOVF9JRCkge1xyXG4gICAgY2FjaGVkRGV2VGVuYW50ID0geyBzbHVnOiBERVZfVEVOQU5UX1NMVUcsIGlkOiBERVZfVEVOQU5UX0lEIH07XHJcbiAgICByZXR1cm4gY2FjaGVkRGV2VGVuYW50O1xyXG4gIH1cclxuICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBmaW5kVGVuYW50QnlQdWJsaWNJZGVudGlmaWVyKHsgc2x1ZzogREVWX1RFTkFOVF9TTFVHIH0pO1xyXG4gIGNhY2hlZERldlRlbmFudCA9IHsgc2x1ZzogREVWX1RFTkFOVF9TTFVHLCBpZDogdGVuYW50Py5pZCA/PyBudWxsIH07XHJcbiAgcmV0dXJuIGNhY2hlZERldlRlbmFudDtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gcmVzb2x2ZVRlbmFudEZyb21Ib3N0KGhvc3Q6IHN0cmluZyB8IG51bGwpOiBQcm9taXNlPFRlbmFudFJlc29sdXRpb24gfCBudWxsPiB7XHJcbiAgaWYgKCFob3N0KSB7XHJcbiAgICByZXR1cm4gcmVzb2x2ZURldlRlbmFudCgpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgbm9ybWFsaXplZEhvc3QgPSBob3N0LnRvTG93ZXJDYXNlKCkuc3BsaXQoXCI6XCIpWzBdO1xyXG5cclxuICBpZiAoXHJcbiAgICBub3JtYWxpemVkSG9zdC5zdGFydHNXaXRoKFwibG9jYWxob3N0XCIpIHx8XHJcbiAgICBub3JtYWxpemVkSG9zdC5zdGFydHNXaXRoKFwiMTI3LlwiKSB8fFxyXG4gICAgbm9ybWFsaXplZEhvc3QgPT09IFwiWzo6MV1cIlxyXG4gICkge1xyXG4gICAgcmV0dXJuIHJlc29sdmVEZXZUZW5hbnQoKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHNlZ21lbnRzID0gbm9ybWFsaXplZEhvc3Quc3BsaXQoXCIuXCIpO1xyXG4gIGNvbnN0IHNsdWdDYW5kaWRhdGUgPSBzZWdtZW50cy5sZW5ndGggPj0gMyAmJiBzZWdtZW50c1swXSAhPT0gXCJ3d3dcIiA/IHNlZ21lbnRzWzBdIDogbnVsbDtcclxuXHJcbiAgY29uc3QgdGVuYW50ID0gYXdhaXQgZmluZFRlbmFudEJ5UHVibGljSWRlbnRpZmllcih7IGRvbWFpbjogbm9ybWFsaXplZEhvc3QsIHNsdWc6IHNsdWdDYW5kaWRhdGUgfSk7XHJcbiAgaWYgKCF0ZW5hbnQpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuICByZXR1cm4geyBzbHVnOiB0ZW5hbnQucHVibGljX3NsdWcgPz8gc2x1Z0NhbmRpZGF0ZSA/PyBudWxsLCBpZDogdGVuYW50LmlkIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICBjb25zdCByZXMgPSBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlTWlkZGxld2FyZUNsaWVudCh7IHJlcSwgcmVzIH0pO1xyXG4gIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xyXG5cclxuICBjb25zdCB7IHBhdGhuYW1lLCBob3N0IH0gPSByZXEubmV4dFVybDtcclxuICBjb25zdCBpc1B1YmxpYyA9IGlzUHVibGljUGF0aChwYXRobmFtZSk7XHJcblxyXG4gIGlmICghaXNQdWJsaWMgJiYgIXNlc3Npb24pIHtcclxuICAgIGNvbnN0IHVybCA9IHJlcS5uZXh0VXJsLmNsb25lKCk7XHJcbiAgICB1cmwucGF0aG5hbWUgPSBcIi9sb2dpblwiO1xyXG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZWRpcmVjdFwiLCBwYXRobmFtZSk7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHVybCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0ZW5hbnRSZXNvbHV0aW9uID0gYXdhaXQgcmVzb2x2ZVRlbmFudEZyb21Ib3N0KGhvc3QpO1xyXG4gIGlmICh0ZW5hbnRSZXNvbHV0aW9uPy5zbHVnKSB7XHJcbiAgICByZXMuaGVhZGVycy5zZXQoXCJ4LXRlbmFudC1pZFwiLCB0ZW5hbnRSZXNvbHV0aW9uLnNsdWcpO1xyXG4gIH1cclxuICBpZiAodGVuYW50UmVzb2x1dGlvbj8uaWQpIHtcclxuICAgIHJlcy5oZWFkZXJzLnNldChcIngtdGVuYW50LWludGVybmFsLWlkXCIsIHRlbmFudFJlc29sdXRpb24uaWQpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBtYXRjaGVyOiBbXCIvKCg/IV9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKilcIl0sXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVNaWRkbGV3YXJlQ2xpZW50IiwiTmV4dFJlc3BvbnNlIiwiZmluZFRlbmFudEJ5UHVibGljSWRlbnRpZmllciIsIlBVQkxJQ19QQVRIX1BSRUZJWEVTIiwiREVWX1RFTkFOVF9TTFVHIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0RFVl9URU5BTlRfU0xVRyIsIkRFVl9URU5BTlRfSUQiLCJORVhUX1BVQkxJQ19ERVZfVEVOQU5UX0lEIiwiY2FjaGVkRGV2VGVuYW50IiwiaXNQdWJsaWNQYXRoIiwicGF0aG5hbWUiLCJzb21lIiwicHJlZml4Iiwic3RhcnRzV2l0aCIsInJlc29sdmVEZXZUZW5hbnQiLCJzbHVnIiwiaWQiLCJ0ZW5hbnQiLCJyZXNvbHZlVGVuYW50RnJvbUhvc3QiLCJob3N0Iiwibm9ybWFsaXplZEhvc3QiLCJ0b0xvd2VyQ2FzZSIsInNwbGl0Iiwic2VnbWVudHMiLCJzbHVnQ2FuZGlkYXRlIiwibGVuZ3RoIiwiZG9tYWluIiwicHVibGljX3NsdWciLCJtaWRkbGV3YXJlIiwicmVxIiwicmVzIiwibmV4dCIsInN1cGFiYXNlIiwiZGF0YSIsInNlc3Npb24iLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsIm5leHRVcmwiLCJpc1B1YmxpYyIsInVybCIsImNsb25lIiwic2VhcmNoUGFyYW1zIiwic2V0IiwicmVkaXJlY3QiLCJ0ZW5hbnRSZXNvbHV0aW9uIiwiaGVhZGVycyIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ }),

/***/ "(middleware)/./src/server/tenant-routing.ts":
/*!**************************************!*\
  !*** ./src/server/tenant-routing.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findTenantByPublicIdentifier: () => (/* binding */ findTenantByPublicIdentifier),\n/* harmony export */   resolveTenantIdFromPublicIdentifier: () => (/* binding */ resolveTenantIdFromPublicIdentifier)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/service */ \"(middleware)/./src/lib/supabase/service.ts\");\n\nconst CACHE_TTL_MS = 5 * 60 * 1000;\nconst tenantCache = new Map();\nfunction readCache(key) {\n    if (!key) return null;\n    const cached = tenantCache.get(key);\n    if (cached && cached.expiresAt > Date.now()) {\n        return cached.tenant;\n    }\n    if (cached) {\n        tenantCache.delete(key);\n    }\n    return null;\n}\nfunction writeCache(keys, tenant) {\n    const expiresAt = Date.now() + CACHE_TTL_MS;\n    keys.forEach((key)=>{\n        if (key) {\n            tenantCache.set(key, {\n                tenant,\n                expiresAt\n            });\n        }\n    });\n}\nasync function findTenantByPublicIdentifier(params) {\n    const normalizedSlug = params.slug?.trim().toLowerCase() ?? null;\n    const normalizedDomain = params.domain?.trim().toLowerCase() ?? null;\n    const normalizedId = params.id?.trim() ?? null;\n    const cacheKeys = [\n        normalizedId ? `id:${normalizedId}` : null,\n        normalizedSlug ? `slug:${normalizedSlug}` : null,\n        normalizedDomain ? `domain:${normalizedDomain}` : null\n    ];\n    for (const key of cacheKeys){\n        const tenant = readCache(key ?? undefined);\n        if (tenant) {\n            return tenant;\n        }\n    }\n    if (!_lib_supabase_service__WEBPACK_IMPORTED_MODULE_0__.serviceClient) {\n        console.warn(\"findTenantByPublicIdentifier: service client not configured\");\n        return null;\n    }\n    const identifiers = [];\n    if (normalizedId) {\n        identifiers.push({\n            column: \"id\",\n            value: normalizedId,\n            cacheKey: `id:${normalizedId}`\n        });\n    }\n    if (normalizedSlug) {\n        identifiers.push({\n            column: \"public_slug\",\n            value: normalizedSlug,\n            cacheKey: `slug:${normalizedSlug}`\n        });\n    }\n    if (normalizedDomain) {\n        identifiers.push({\n            column: \"custom_domain\",\n            value: normalizedDomain,\n            cacheKey: `domain:${normalizedDomain}`\n        });\n    }\n    if (identifiers.length === 0) {\n        return null;\n    }\n    let query = _lib_supabase_service__WEBPACK_IMPORTED_MODULE_0__.serviceClient.from(\"agenda_tenants\").select(\"id, name, public_slug, custom_domain, public_metadata\").limit(1);\n    if (identifiers.length === 1) {\n        const identifier = identifiers[0];\n        query = query.eq(identifier.column, identifier.value);\n    } else {\n        const orFilter = identifiers.map((item)=>`${item.column}.eq.${item.value}`).join(\",\");\n        query = query.or(orFilter);\n    }\n    const { data, error } = await query.maybeSingle();\n    if (error) {\n        console.error(\"findTenantByPublicIdentifier: query failed\", error);\n        return null;\n    }\n    if (!data) {\n        return null;\n    }\n    const tenant = data;\n    writeCache([\n        `id:${tenant.id}`,\n        tenant.public_slug ? `slug:${tenant.public_slug}` : null,\n        tenant.custom_domain ? `domain:${tenant.custom_domain}` : null\n    ], tenant);\n    return tenant;\n}\nasync function resolveTenantIdFromPublicIdentifier(params) {\n    if (params.tenantId) {\n        return params.tenantId;\n    }\n    const tenant = await findTenantByPublicIdentifier({\n        slug: params.tenantSlug ?? null,\n        domain: params.domain ?? null\n    });\n    return tenant?.id ?? null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL3NlcnZlci90ZW5hbnQtcm91dGluZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBdUQ7QUFjdkQsTUFBTUMsZUFBZSxJQUFJLEtBQUs7QUFDOUIsTUFBTUMsY0FBYyxJQUFJQztBQUV4QixTQUFTQyxVQUFVQyxHQUE4QjtJQUMvQyxJQUFJLENBQUNBLEtBQUssT0FBTztJQUNqQixNQUFNQyxTQUFTSixZQUFZSyxHQUFHLENBQUNGO0lBQy9CLElBQUlDLFVBQVVBLE9BQU9FLFNBQVMsR0FBR0MsS0FBS0MsR0FBRyxJQUFJO1FBQzNDLE9BQU9KLE9BQU9LLE1BQU07SUFDdEI7SUFDQSxJQUFJTCxRQUFRO1FBQ1ZKLFlBQVlVLE1BQU0sQ0FBQ1A7SUFDckI7SUFDQSxPQUFPO0FBQ1Q7QUFFQSxTQUFTUSxXQUFXQyxJQUFtQyxFQUFFSCxNQUEwQjtJQUNqRixNQUFNSCxZQUFZQyxLQUFLQyxHQUFHLEtBQUtUO0lBQy9CYSxLQUFLQyxPQUFPLENBQUMsQ0FBQ1Y7UUFDWixJQUFJQSxLQUFLO1lBQ1BILFlBQVljLEdBQUcsQ0FBQ1gsS0FBSztnQkFBRU07Z0JBQVFIO1lBQVU7UUFDM0M7SUFDRjtBQUNGO0FBRU8sZUFBZVMsNkJBQTZCQyxNQUlsRDtJQUNDLE1BQU1DLGlCQUFpQkQsT0FBT0UsSUFBSSxFQUFFQyxPQUFPQyxpQkFBaUI7SUFDNUQsTUFBTUMsbUJBQW1CTCxPQUFPTSxNQUFNLEVBQUVILE9BQU9DLGlCQUFpQjtJQUNoRSxNQUFNRyxlQUFlUCxPQUFPUSxFQUFFLEVBQUVMLFVBQVU7SUFFMUMsTUFBTU0sWUFBWTtRQUNoQkYsZUFBZSxDQUFDLEdBQUcsRUFBRUEsYUFBYSxDQUFDLEdBQUc7UUFDdENOLGlCQUFpQixDQUFDLEtBQUssRUFBRUEsZUFBZSxDQUFDLEdBQUc7UUFDNUNJLG1CQUFtQixDQUFDLE9BQU8sRUFBRUEsaUJBQWlCLENBQUMsR0FBRztLQUNuRDtJQUVELEtBQUssTUFBTWxCLE9BQU9zQixVQUFXO1FBQzNCLE1BQU1oQixTQUFTUCxVQUFVQyxPQUFPdUI7UUFDaEMsSUFBSWpCLFFBQVE7WUFDVixPQUFPQTtRQUNUO0lBQ0Y7SUFFQSxJQUFJLENBQUNYLGdFQUFhQSxFQUFFO1FBQ2xCNkIsUUFBUUMsSUFBSSxDQUFDO1FBQ2IsT0FBTztJQUNUO0lBRUEsTUFBTUMsY0FBNEIsRUFBRTtJQUNwQyxJQUFJTixjQUFjO1FBQ2hCTSxZQUFZQyxJQUFJLENBQUM7WUFBRUMsUUFBUTtZQUFNQyxPQUFPVDtZQUFjVSxVQUFVLENBQUMsR0FBRyxFQUFFVixhQUFhLENBQUM7UUFBQztJQUN2RjtJQUNBLElBQUlOLGdCQUFnQjtRQUNsQlksWUFBWUMsSUFBSSxDQUFDO1lBQUVDLFFBQVE7WUFBZUMsT0FBT2Y7WUFBZ0JnQixVQUFVLENBQUMsS0FBSyxFQUFFaEIsZUFBZSxDQUFDO1FBQUM7SUFDdEc7SUFDQSxJQUFJSSxrQkFBa0I7UUFDcEJRLFlBQVlDLElBQUksQ0FBQztZQUFFQyxRQUFRO1lBQWlCQyxPQUFPWDtZQUFrQlksVUFBVSxDQUFDLE9BQU8sRUFBRVosaUJBQWlCLENBQUM7UUFBQztJQUM5RztJQUVBLElBQUlRLFlBQVlLLE1BQU0sS0FBSyxHQUFHO1FBQzVCLE9BQU87SUFDVDtJQUVBLElBQUlDLFFBQVFyQyxnRUFBYUEsQ0FDdEJzQyxJQUFJLENBQUMsa0JBQ0xDLE1BQU0sQ0FBQyx5REFDUEMsS0FBSyxDQUFDO0lBRVQsSUFBSVQsWUFBWUssTUFBTSxLQUFLLEdBQUc7UUFDNUIsTUFBTUssYUFBYVYsV0FBVyxDQUFDLEVBQUU7UUFDakNNLFFBQVFBLE1BQU1LLEVBQUUsQ0FBQ0QsV0FBV1IsTUFBTSxFQUFFUSxXQUFXUCxLQUFLO0lBQ3RELE9BQU87UUFDTCxNQUFNUyxXQUFXWixZQUFZYSxHQUFHLENBQUMsQ0FBQ0MsT0FBUyxDQUFDLEVBQUVBLEtBQUtaLE1BQU0sQ0FBQyxJQUFJLEVBQUVZLEtBQUtYLEtBQUssQ0FBQyxDQUFDLEVBQUVZLElBQUksQ0FBQztRQUNuRlQsUUFBUUEsTUFBTVUsRUFBRSxDQUFDSjtJQUNuQjtJQUVBLE1BQU0sRUFBRUssSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNWixNQUFNYSxXQUFXO0lBRS9DLElBQUlELE9BQU87UUFDVHBCLFFBQVFvQixLQUFLLENBQUMsOENBQThDQTtRQUM1RCxPQUFPO0lBQ1Q7SUFFQSxJQUFJLENBQUNELE1BQU07UUFDVCxPQUFPO0lBQ1Q7SUFFQSxNQUFNckMsU0FBU3FDO0lBQ2ZuQyxXQUNFO1FBQ0UsQ0FBQyxHQUFHLEVBQUVGLE9BQU9lLEVBQUUsQ0FBQyxDQUFDO1FBQ2pCZixPQUFPd0MsV0FBVyxHQUFHLENBQUMsS0FBSyxFQUFFeEMsT0FBT3dDLFdBQVcsQ0FBQyxDQUFDLEdBQUc7UUFDcER4QyxPQUFPeUMsYUFBYSxHQUFHLENBQUMsT0FBTyxFQUFFekMsT0FBT3lDLGFBQWEsQ0FBQyxDQUFDLEdBQUc7S0FDM0QsRUFDRHpDO0lBR0YsT0FBT0E7QUFDVDtBQUVPLGVBQWUwQyxvQ0FBb0NuQyxNQUl6RDtJQUNDLElBQUlBLE9BQU9vQyxRQUFRLEVBQUU7UUFDbkIsT0FBT3BDLE9BQU9vQyxRQUFRO0lBQ3hCO0lBRUEsTUFBTTNDLFNBQVMsTUFBTU0sNkJBQTZCO1FBQUVHLE1BQU1GLE9BQU9xQyxVQUFVLElBQUk7UUFBTS9CLFFBQVFOLE9BQU9NLE1BQU0sSUFBSTtJQUFLO0lBQ25ILE9BQU9iLFFBQVFlLE1BQU07QUFDdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL3NlcnZlci90ZW5hbnQtcm91dGluZy50cz8xYzRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlcnZpY2VDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Uvc2VydmljZVwiO1xyXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gXCJAL3R5cGVzL2RhdGFiYXNlXCI7XHJcblxyXG5leHBvcnQgdHlwZSBUZW5hbnRQdWJsaWNSZWNvcmQgPSBQaWNrPFxyXG4gIERhdGFiYXNlW1wicHVibGljXCJdW1wiVGFibGVzXCJdW1wiYWdlbmRhX3RlbmFudHNcIl1bXCJSb3dcIl0sXHJcbiAgXCJpZFwiIHwgXCJuYW1lXCIgfCBcInB1YmxpY19zbHVnXCIgfCBcImN1c3RvbV9kb21haW5cIiB8IFwicHVibGljX21ldGFkYXRhXCJcclxuPjtcclxuXHJcbnR5cGUgSWRlbnRpZmllciA9IHtcclxuICBjb2x1bW46IFwiaWRcIiB8IFwicHVibGljX3NsdWdcIiB8IFwiY3VzdG9tX2RvbWFpblwiO1xyXG4gIHZhbHVlOiBzdHJpbmc7XHJcbiAgY2FjaGVLZXk6IHN0cmluZztcclxufTtcclxuXHJcbmNvbnN0IENBQ0hFX1RUTF9NUyA9IDUgKiA2MCAqIDEwMDA7XHJcbmNvbnN0IHRlbmFudENhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgdGVuYW50OiBUZW5hbnRQdWJsaWNSZWNvcmQ7IGV4cGlyZXNBdDogbnVtYmVyIH0+KCk7XHJcblxyXG5mdW5jdGlvbiByZWFkQ2FjaGUoa2V5OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKSB7XHJcbiAgaWYgKCFrZXkpIHJldHVybiBudWxsO1xyXG4gIGNvbnN0IGNhY2hlZCA9IHRlbmFudENhY2hlLmdldChrZXkpO1xyXG4gIGlmIChjYWNoZWQgJiYgY2FjaGVkLmV4cGlyZXNBdCA+IERhdGUubm93KCkpIHtcclxuICAgIHJldHVybiBjYWNoZWQudGVuYW50O1xyXG4gIH1cclxuICBpZiAoY2FjaGVkKSB7XHJcbiAgICB0ZW5hbnRDYWNoZS5kZWxldGUoa2V5KTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdyaXRlQ2FjaGUoa2V5czogKHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpW10sIHRlbmFudDogVGVuYW50UHVibGljUmVjb3JkKSB7XHJcbiAgY29uc3QgZXhwaXJlc0F0ID0gRGF0ZS5ub3coKSArIENBQ0hFX1RUTF9NUztcclxuICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICB0ZW5hbnRDYWNoZS5zZXQoa2V5LCB7IHRlbmFudCwgZXhwaXJlc0F0IH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmluZFRlbmFudEJ5UHVibGljSWRlbnRpZmllcihwYXJhbXM6IHtcclxuICBpZD86IHN0cmluZyB8IG51bGw7XHJcbiAgc2x1Zz86IHN0cmluZyB8IG51bGw7XHJcbiAgZG9tYWluPzogc3RyaW5nIHwgbnVsbDtcclxufSk6IFByb21pc2U8VGVuYW50UHVibGljUmVjb3JkIHwgbnVsbD4ge1xyXG4gIGNvbnN0IG5vcm1hbGl6ZWRTbHVnID0gcGFyYW1zLnNsdWc/LnRyaW0oKS50b0xvd2VyQ2FzZSgpID8/IG51bGw7XHJcbiAgY29uc3Qgbm9ybWFsaXplZERvbWFpbiA9IHBhcmFtcy5kb21haW4/LnRyaW0oKS50b0xvd2VyQ2FzZSgpID8/IG51bGw7XHJcbiAgY29uc3Qgbm9ybWFsaXplZElkID0gcGFyYW1zLmlkPy50cmltKCkgPz8gbnVsbDtcclxuXHJcbiAgY29uc3QgY2FjaGVLZXlzID0gW1xyXG4gICAgbm9ybWFsaXplZElkID8gYGlkOiR7bm9ybWFsaXplZElkfWAgOiBudWxsLFxyXG4gICAgbm9ybWFsaXplZFNsdWcgPyBgc2x1Zzoke25vcm1hbGl6ZWRTbHVnfWAgOiBudWxsLFxyXG4gICAgbm9ybWFsaXplZERvbWFpbiA/IGBkb21haW46JHtub3JtYWxpemVkRG9tYWlufWAgOiBudWxsLFxyXG4gIF07XHJcblxyXG4gIGZvciAoY29uc3Qga2V5IG9mIGNhY2hlS2V5cykge1xyXG4gICAgY29uc3QgdGVuYW50ID0gcmVhZENhY2hlKGtleSA/PyB1bmRlZmluZWQpO1xyXG4gICAgaWYgKHRlbmFudCkge1xyXG4gICAgICByZXR1cm4gdGVuYW50O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKCFzZXJ2aWNlQ2xpZW50KSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJmaW5kVGVuYW50QnlQdWJsaWNJZGVudGlmaWVyOiBzZXJ2aWNlIGNsaWVudCBub3QgY29uZmlndXJlZFwiKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaWRlbnRpZmllcnM6IElkZW50aWZpZXJbXSA9IFtdO1xyXG4gIGlmIChub3JtYWxpemVkSWQpIHtcclxuICAgIGlkZW50aWZpZXJzLnB1c2goeyBjb2x1bW46IFwiaWRcIiwgdmFsdWU6IG5vcm1hbGl6ZWRJZCwgY2FjaGVLZXk6IGBpZDoke25vcm1hbGl6ZWRJZH1gIH0pO1xyXG4gIH1cclxuICBpZiAobm9ybWFsaXplZFNsdWcpIHtcclxuICAgIGlkZW50aWZpZXJzLnB1c2goeyBjb2x1bW46IFwicHVibGljX3NsdWdcIiwgdmFsdWU6IG5vcm1hbGl6ZWRTbHVnLCBjYWNoZUtleTogYHNsdWc6JHtub3JtYWxpemVkU2x1Z31gIH0pO1xyXG4gIH1cclxuICBpZiAobm9ybWFsaXplZERvbWFpbikge1xyXG4gICAgaWRlbnRpZmllcnMucHVzaCh7IGNvbHVtbjogXCJjdXN0b21fZG9tYWluXCIsIHZhbHVlOiBub3JtYWxpemVkRG9tYWluLCBjYWNoZUtleTogYGRvbWFpbjoke25vcm1hbGl6ZWREb21haW59YCB9KTtcclxuICB9XHJcblxyXG4gIGlmIChpZGVudGlmaWVycy5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgbGV0IHF1ZXJ5ID0gc2VydmljZUNsaWVudFxyXG4gICAgLmZyb20oXCJhZ2VuZGFfdGVuYW50c1wiKVxyXG4gICAgLnNlbGVjdChcImlkLCBuYW1lLCBwdWJsaWNfc2x1ZywgY3VzdG9tX2RvbWFpbiwgcHVibGljX21ldGFkYXRhXCIpXHJcbiAgICAubGltaXQoMSk7XHJcblxyXG4gIGlmIChpZGVudGlmaWVycy5sZW5ndGggPT09IDEpIHtcclxuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBpZGVudGlmaWVyc1swXTtcclxuICAgIHF1ZXJ5ID0gcXVlcnkuZXEoaWRlbnRpZmllci5jb2x1bW4sIGlkZW50aWZpZXIudmFsdWUpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zdCBvckZpbHRlciA9IGlkZW50aWZpZXJzLm1hcCgoaXRlbSkgPT4gYCR7aXRlbS5jb2x1bW59LmVxLiR7aXRlbS52YWx1ZX1gKS5qb2luKFwiLFwiKTtcclxuICAgIHF1ZXJ5ID0gcXVlcnkub3Iob3JGaWx0ZXIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnkubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiZmluZFRlbmFudEJ5UHVibGljSWRlbnRpZmllcjogcXVlcnkgZmFpbGVkXCIsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFkYXRhKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRlbmFudCA9IGRhdGEgYXMgVGVuYW50UHVibGljUmVjb3JkO1xyXG4gIHdyaXRlQ2FjaGUoXHJcbiAgICBbXHJcbiAgICAgIGBpZDoke3RlbmFudC5pZH1gLFxyXG4gICAgICB0ZW5hbnQucHVibGljX3NsdWcgPyBgc2x1Zzoke3RlbmFudC5wdWJsaWNfc2x1Z31gIDogbnVsbCxcclxuICAgICAgdGVuYW50LmN1c3RvbV9kb21haW4gPyBgZG9tYWluOiR7dGVuYW50LmN1c3RvbV9kb21haW59YCA6IG51bGwsXHJcbiAgICBdLFxyXG4gICAgdGVuYW50LFxyXG4gICk7XHJcblxyXG4gIHJldHVybiB0ZW5hbnQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXNvbHZlVGVuYW50SWRGcm9tUHVibGljSWRlbnRpZmllcihwYXJhbXM6IHtcclxuICB0ZW5hbnRJZD86IHN0cmluZyB8IG51bGw7XHJcbiAgdGVuYW50U2x1Zz86IHN0cmluZyB8IG51bGw7XHJcbiAgZG9tYWluPzogc3RyaW5nIHwgbnVsbDtcclxufSk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gIGlmIChwYXJhbXMudGVuYW50SWQpIHtcclxuICAgIHJldHVybiBwYXJhbXMudGVuYW50SWQ7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBmaW5kVGVuYW50QnlQdWJsaWNJZGVudGlmaWVyKHsgc2x1ZzogcGFyYW1zLnRlbmFudFNsdWcgPz8gbnVsbCwgZG9tYWluOiBwYXJhbXMuZG9tYWluID8/IG51bGwgfSk7XHJcbiAgcmV0dXJuIHRlbmFudD8uaWQgPz8gbnVsbDtcclxufVxyXG4iXSwibmFtZXMiOlsic2VydmljZUNsaWVudCIsIkNBQ0hFX1RUTF9NUyIsInRlbmFudENhY2hlIiwiTWFwIiwicmVhZENhY2hlIiwia2V5IiwiY2FjaGVkIiwiZ2V0IiwiZXhwaXJlc0F0IiwiRGF0ZSIsIm5vdyIsInRlbmFudCIsImRlbGV0ZSIsIndyaXRlQ2FjaGUiLCJrZXlzIiwiZm9yRWFjaCIsInNldCIsImZpbmRUZW5hbnRCeVB1YmxpY0lkZW50aWZpZXIiLCJwYXJhbXMiLCJub3JtYWxpemVkU2x1ZyIsInNsdWciLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJub3JtYWxpemVkRG9tYWluIiwiZG9tYWluIiwibm9ybWFsaXplZElkIiwiaWQiLCJjYWNoZUtleXMiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwid2FybiIsImlkZW50aWZpZXJzIiwicHVzaCIsImNvbHVtbiIsInZhbHVlIiwiY2FjaGVLZXkiLCJsZW5ndGgiLCJxdWVyeSIsImZyb20iLCJzZWxlY3QiLCJsaW1pdCIsImlkZW50aWZpZXIiLCJlcSIsIm9yRmlsdGVyIiwibWFwIiwiaXRlbSIsImpvaW4iLCJvciIsImRhdGEiLCJlcnJvciIsIm1heWJlU2luZ2xlIiwicHVibGljX3NsdWciLCJjdXN0b21fZG9tYWluIiwicmVzb2x2ZVRlbmFudElkRnJvbVB1YmxpY0lkZW50aWZpZXIiLCJ0ZW5hbnRJZCIsInRlbmFudFNsdWciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/server/tenant-routing.ts\n");

/***/ })

});